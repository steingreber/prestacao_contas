/**
 * JavaScript for PHPMaker 2018
 * @license (C)2002-2018 e.World Technology Ltd.
 */
var ewAddOptDialog,ewEmailDialog,$rowindex$=null;var ewModalDialog,ewModalLookupDialog;var EW_TABLE_CLASSNAME="ewTable";var EW_GRID_CLASSNAME="ewGrid";var EW_MULTI_COLUMN_GRID_CLASSNAME="ewMultiColumnGrid";var EW_TABLE_ROW_CLASSNAME="ewTableRow";var EW_TABLE_ALT_ROW_CLASSNAME="ewTableAltRow";var EW_ITEM_TEMPLATE_CLASSNAME="ewTemplate";var EW_ITEM_TABLE_CLASSNAME="ewItemTable";var EW_TABLE_LAST_ROW_CLASSNAME="ewTableLastRow";var EW_TABLE_LAST_COL_CLASSNAME="ewTableLastCol";var EW_TABLE_PREVIEW_ROW_CLASSNAME="ewTablePreviewRow";var EW_TABLE_EDIT_ROW_CLASSNAME="ewTableEditRow";var EW_TABLE_SELECT_ROW_CLASSNAME="ewTableSelectRow";var EW_TABLE_HIGHLIGHT_ROW_CLASSNAME="ewTableHighlightRow";var EW_TABLE_BORDER_BOTTOM_CLASSNAME="ewTableBorderBottom";var EW_REPORT_CONTAINER_ID="ewContainer";var EW_ROWTYPE_ADD=2;var EW_ROWTYPE_EDIT=3;var EW_UNFORMAT_YEAR=50;var EW_AJAX_DELAY=10;var EW_LOOKUP_DELAY=250;var EW_LAZY_LOAD_DELAY=250;var EW_SHOW_EXPORT_DIALOG=true;var EW_IS_SCREEN_SM_MIN=window.matchMedia&&window.matchMedia("(min-width: 768px)").matches||!window.matchMedia&&jQuery(window).width()>=768;var ew_ClientScriptInclude=jQuery.getScript;var ewLightboxSettings={transition:"none",photo:true,opacity:.5};var ewAutoSuggestSettings={highlight:true,hint:true,minLength:1,limit:EW_AUTO_SUGGEST_MAX_ENTRIES,trigger:"click",delay:0,templates:{footer:'<div class="tt-footer"><a href="#" class="tt-more"></a></div>'}};(function(e){e(document).on("addoption",function(t,a){var r=a.data;var i=a.parents;for(var n=0,o=i.length;n<o;n++){var s=i[n];if(!s.length)return a.valid=false;var l=r[5+n];if(!e.isUndefined(l)&&!s.includes(String(l)))return a.valid=false}});e(document).on("overflow",function(t,a){if(!EW_IS_MOBILE&&EW_IS_SCREEN_SM_MIN){e("body").data("reset-height",false);e("body, .wrapper").css("overflow-x","auto")}})})(jQuery);function ew_InitIcons(e){var t=jQuery,a=e&&e.target?e.target:document;t(a).find(".ewIcon").closest("a, button").add(".ewTooltip").tooltip({container:"body",trigger:EW_IS_MOBILE?"manual":"hover",placement:"bottom"})}function ew_InitPasswordOptions(e){var t=jQuery,a=e&&e.target?e.target:document;var r=function(e){return ewLanguage.Phrase("CurrentPassword")+e};if(t.fn.pStrength&&typeof EW_MIN_PASSWORD_STRENGTH!="undefined"){t(a).find(".ewPasswordStrength").each(function(){var e=t(this);if(!e.data("pStrength"))e.pStrength({changeBackground:false,backgrounds:[],passwordValidFrom:EW_MIN_PASSWORD_STRENGTH,onPasswordStrengthChanged:function(e,a){var r=t(this),i=t("[id='"+r.attr("data-password-strength")+"']"),n=i.find(".progress-bar");if(r.val()){var o=a+"%";if(a<25){n.addClass("progress-bar-danger").removeClass("progress-bar-warning progress-bar-info progress-bar-success")}else if(a<50){n.addClass("progress-bar-warning").removeClass("progress-bar-danger progress-bar-info progress-bar-success")}else if(a<75){n.addClass("progress-bar-info").removeClass("progress-bar-danger progress-bar-warning progress-bar-success")}else{n.addClass("progress-bar-success").removeClass("progress-bar-danger progress-bar-warning progress-bar-info")}n.css("width",o);if(a>25)o=ewLanguage.Phrase("PasswordStrength").replace("%p",o);n.html(o);i.show();r.data("validated",a>=EW_MIN_PASSWORD_STRENGTH)}else{i.hide();r.data("validated",false)}}}).on("keyup change",function(){var e=t(this),a=t("#"+e.data("password-generated"));if(a.is(":visible")){a.toggle(!!e.val());a.html(r(e.val()))}})})}if(t.fn.pGenerator){t(a).find(".ewPasswordGenerator").each(function(){var e=t(this);if(!e.data("pGenerator"))e.pGenerator({passwordLength:EW_GENERATE_PASSWORD_LENGTH,uppercase:EW_GENERATE_PASSWORD_UPPERCASE,lowercase:EW_GENERATE_PASSWORD_LOWERCASE,numbers:EW_GENERATE_PASSWORD_NUMBER,specialChars:EW_GENERATE_PASSWORD_SPECIALCHARS,onPasswordGenerated:function(e){var a=t(this);t("#"+a.attr("data-password-field")).val(e).change().focus().triggerHandler("click");t("#"+a.attr("data-password-confirm")).val(e);t("#"+a.attr("data-password-strength")).hide();t("#"+a.attr("data-password-generated")).html(r(e)).show()}})})}}function ew_SetSessionTimer(){var e=jQuery,t,a,r,i,n,o=e("#ewTimer"),s=(EW_SESSION_KEEP_ALIVE_INTERVAL>0||EW_IS_LOGGEDIN&&EW_IS_AUTOLOGIN)&&EW_SESSION_URL;var l=function(){var t=EW_SESSION_URL+"?rnd="+ew_Random();e.get(t,function(t){EW_TOKEN=t;e("input:hidden[name=token]").val(t)})};o.find(".modal-footer .btn-primary").click(function(e){if(r)r.cancel();o.modal("hide");l();if(!s&&EW_SESSION_TIMEOUT>0)f()});var d=function(){n=EW_SESSION_TIMEOUT_COUNTDOWN;t=EW_SESSION_TIMEOUT-EW_SESSION_TIMEOUT_COUNTDOWN;if(t<0){t=0;n=EW_SESSION_TIMEOUT}if(r)r.cancel();if(a)a.cancel()};var u=function(){if(i)i.cancel();r=e.later(1e3,null,function(){if(n>0){o.find(".modal-body").html('<p class="text-danger">'+ewLanguage.Phrase("SessionWillExpire").replace("%s",n)+"</p>");o.modal("show")}else{o.find(".modal-body").html('<p class="text-danger">'+ewLanguage.Phrase("SessionExpired")+"</p>");d();e.later(1e3,null,function(){o.modal("hide");window.location=EW_TIMEOUT_URL+"?expired=1"})}n--},null,true)};var f=function(){d();a=e.later(t*1e3,null,u)};if(s){var c=EW_SESSION_KEEP_ALIVE_INTERVAL>0?EW_SESSION_KEEP_ALIVE_INTERVAL:EW_SESSION_TIMEOUT-EW_SESSION_TIMEOUT_COUNTDOWN;if(c<=0)c=60;i=e.later(c*1e3,null,l,null,true)}else{if(EW_SESSION_TIMEOUT>0)f()}}function ew_InitExportLinks(e){var t=jQuery,a=e&&e.target?e.target:document;t(a).find(".ewExportLink[href]:not(.ewEmail):not(.ewPrint):not(.ewXml)").click(function(e){var a,r=t(this),i=r.attr("href");if(i)ew_FileDownload(i);e.preventDefault()})}function ew_InitMultiSelectCheckboxes(e){var t=jQuery,a=e&&e.target?e.target:document;var r=t(a).find("input[type=checkbox].ewMultiSelect");r.click(function(e){var a=this.name.split("_")[0],i=r.filter("[name^='"+a+"_']"),n=i.length,o=i.filter(":checked").length;t(this.form).find("input[type=checkbox]#"+a).prop("checked",o==n).prop("indeterminate",o!=n&&o!=0)})}function ew_FileDownload(e,t){var a=window.location!=window.parent.location&&window.parent.jQuery?window.parent.jQuery:jQuery;a("body").css("cursor","wait");if(EW_SHOW_EXPORT_DIALOG){$dlg=a("#ewMsgBox");$dlg.find(".modal-body").html("<p>"+ewLanguage.Phrase("Exporting")+"</p>");$dlg.find(".modal-footer button").prop("disabled",true);$dlg.modal("show")}var r=t?"POST":"GET";a.fileDownload(e,{httpMethod:r,data:t||null,successCallback:function(e){if(EW_SHOW_EXPORT_DIALOG)$dlg.modal("hide");a(document).trigger("export",[{type:"done",url:e}])},failCallback:function(e,t){if(EW_SHOW_EXPORT_DIALOG)$dlg.find(".modal-body").html("<div class='text-danger'><h4>"+ewLanguage.Phrase("FailedToExport")+"</h4>"+e+"</div>");a(document).trigger("export",[{type:"fail",url:t}])}}).always(function(){if(EW_SHOW_EXPORT_DIALOG)$dlg.find(".modal-footer button").prop("disabled",false);a("body").css("cursor","default");a(document).trigger("export",[{type:"always",url:e}])})}function ew_LazyLoad(e){if(!EW_LAZY_LOAD)return;var t=jQuery,a=e&&e.target?e.target:document,r=t(a).find("img.ewLazy"),i=r.length;r.each(function(e){var a=this;t.later(e*EW_LAZY_LOAD_DELAY,null,function(){var r=t(a),n=r.data("src");if(n)r.prop("src",n);if(e==i-1)t(document).trigger("lazyload")})})}function ew_InitLightboxes(e){var t=jQuery,a=e&&e.target?e.target:document;t.extend(ewLightboxSettings,{title:ewLanguage.Phrase("LightboxTitle"),current:ewLanguage.Phrase("LightboxCurrent"),previous:ewLanguage.Phrase("LightboxPrevious"),next:ewLanguage.Phrase("LightboxNext"),close:ewLanguage.Phrase("LightboxClose"),xhrError:ewLanguage.Phrase("LightboxXhrError"),imgError:ewLanguage.Phrase("LightboxImgError")});t(a).find(".ewLightbox").each(function(){var e=t(this);e.colorbox(t.extend({rel:e.data("rel")},ewLightboxSettings))})}function ew_InitTooltips(e){var t=jQuery,a=e&&e.target?e.target:document;t(a).find("input[data-toggle=tooltip],textarea[data-toggle=tooltip],select[data-toggle=tooltip]").each(function(){var e=t(this);e.tooltip(t.extend({html:true,placement:"bottom"},e.data()))});t(a).find("a.ewTooltipLink").each(ew_Tooltip);t(a).find(".ewTooltip").tooltip({placement:"bottom"});t(a).find(".ewPopover").popover()}jQuery(function(e){var t=e("#ewModalDialog");ew_SetSessionTimer();ew_InitTooltips();t.on("load.ew",ew_InitTooltips);ew_InitPasswordOptions();t.on("load.ew",ew_InitPasswordOptions);ew_InitIcons();t.on("load.ew",ew_InitIcons);ew_InitLightboxes();t.on("load.ew",ew_InitLightboxes);e("table."+EW_TABLE_CLASSNAME+":not(.ewExportTable):not(#"+EW_REPORT_CONTAINER_ID+" table)").each(ew_SetupTable);e("table."+EW_GRID_CLASSNAME+":not(.ewExportTable):not(#"+EW_REPORT_CONTAINER_ID+" table)").each(ew_SetupGrid);e(".ewButtonDropdown").on("shown.bs.dropdown",function(){var t=e(this).removeClass("dropup"),a=e(window);$menu=t.find("> .dropdown-menu");t.toggleClass("dropup",$menu.offset().top+$menu.height()>a.scrollTop()+a.height())});e("input[name=pageno]").keypress(function(e){if(e.which==13){var t=window.location.href,a=t.lastIndexOf(window.location.search);window.location=t.substr(0,a)+"?"+this.name+"="+parseInt(this.value);return false}});if(!EW_IS_SCREEN_SM_MIN){e(".table-responsive [data-toggle='dropdown']").parent().on("shown.bs.dropdown",function(){var t=e(this),a=t.find(".dropdown-menu"),r=t.closest(".table-responsive")[0];if(r.scrollHeight-r.clientHeight){var i=a.offset().top+a.outerHeight()-e(r).offset().top-r.clientHeight;if(i>0)a.css(EW_CSS_FLIP?"right":"left","100%").css("top",parseFloat(a.css("top"))-i)}})}ew_LazyLoad();t.on("load.ew",ew_LazyLoad);ew_InitExportLinks();t.on("load.ew",ew_InitExportLinks);ew_InitMultiSelectCheckboxes();t.on("load.ew",ew_InitMultiSelectCheckboxes);t.on("load.ew",ew_RenderJsTemplates);if(typeof EW_USE_JAVASCRIPT_MESSAGE!="undefined"&&EW_USE_JAVASCRIPT_MESSAGE){ew_ShowMessage();t.on("load.ew",ew_ShowMessage)}var a=ew_Get("hash");if(a&&a.length)e("html, body").animate({scrollTop:e("#"+a[0]).offset().top},800)});$(document).on("show.bs.modal",".modal",function(){var e=1050+10*$(".modal:visible").length;$(this).css("z-index",e);setTimeout(function(){$(".modal-backdrop").not(".modal-stack").css("z-index",e-1).addClass("modal-stack")},0)});$(document).on("hidden.bs.modal",".modal",function(){$(".modal:visible").length&&$(document.body).addClass("modal-open")});var ewForms=function(e){var t=jQuery.isString(e)?e:ew_GetForm(e).id;return arguments.callee[t]};function ew_Form(e,t){var a=jQuery;this.ID=e;this.PageID=t;this.$Element=null;this.Form=null;this.InitSearchPanel=false;this.Modified=false;this.SrchOprChanged=function(e){var t=this.GetForm(),r=a(t),i=a.isString(e)?t.elements[e]:e;if(!i)return;var n=i.id.substr(2),o=a(i).val(),s=o=="BETWEEN",l=o=="IS NULL"||o=="IS NOT NULL";if(/^z_/.test(i.id))r.find("[name^=x_"+n+"],[name^=cal_x_"+n+"]").prop("disabled",l);if(/^w_/.test(i.id))r.find("[name^=y_"+n+"],[name^=cal_y_"+n+"]").prop("disabled",l);r.find("span.btw0_"+n).toggle(!s).end().find("span.btw1_"+n).toggle(s).find(":input").prop("disabled",!s)};this.ValidateRequired=true;this.Validate=null;this.DisableForm=function(){if(!EW_DISABLE_BUTTON_ON_SUBMIT)return;var e=this.GetForm();a(e).find(":submit:not(.dropdown-toggle)").prop("disabled",true).addClass("disabled")};this.EnableForm=function(){if(!EW_DISABLE_BUTTON_ON_SUBMIT)return;var e=this.GetForm();a(e).find(":submit:not(.dropdown-toggle)").prop("disabled",false).removeClass("disabled")};this.AppendHidden=function(e){var t=this.GetForm(),r=a(t),i=a(e).closest(".ewForm"),n=i.attr("id")+"$"+e.name;if(r.find("input:hidden[name='"+n+"']")[0])return;var o=i.find("[name='"+e.name+"']").serializeArray();if(o.length){a.each(o,function(e,t){a("<input type='hidden' name='"+n+"'>").val(t.value).appendTo(r)})}else{a("<input type='hidden' name='"+n+"'>").val("").appendTo(r)}};this.CanSubmit=function(){var e=this.GetForm(),t=a(e),r=this;this.DisableForm();this.UpdateTextArea();this.PostAutoSuggest();if(!this.Validate||this.Validate()&&!t.find(".has-error")[0]){t.find("input[name^=sv_], .ewTemplate input").prop("disabled",true);t.find("[data-readonly=1][disabled]").prop("disabled",false);var i=a(t.find("input[name='detailpage']").map(function(e,a){return t.find("#"+a.value).get()}));if(i.length>1){i.each(function(e,t){a(t).find(":input").each(function(e,a){if(/^(fn_)?(x|o)\d*_/.test(a.name)){var n=i.not(t).find(":input[name='"+a.name+"']");if(n.length){r.AppendHidden(a);n.each(function(){r.AppendHidden(this)})}}})})}return true}else{this.EnableForm()}return false};this.Submit=function(e){var t=this.GetForm();if(this.CanSubmit()){if(e)t.action=e;t.submit()}return false};this.EmptyRow=null;this.MultiPage=null;this.Lists=function(e){e=e.replace(/^[xy](\d*|\$rowindex\$)_/,"x_");return this.Lists[e]};this.CompileTemplates=function(){for(var e in this.Lists){var t=this.Lists[e];if(t.Template&&a.isString(t.Template))t.Template=a.templates(t.Template)}};this.AutoSuggests={};this.GetForm=function(){if(!this.Form){this.$Element=a("#"+this.ID);if(this.$Element.is("form")){this.Form=this.$Element[0]}else if(this.$Element.is("div")){this.Form=this.$Element.closest("form")[0]}}return this.Form};this.GetElement=function(e){if(!this.$Element)this.$Element=a("#"+this.ID);return e?ew_GetElement(e,this.$Element):this.$Element[0]};this.GetElements=function(e){if(!this.$Element)this.$Element=a("#"+this.ID);var t="[name='"+e+"']";t="input"+t+",select"+t+",textarea"+t+",button"+t;var r=this.$Element.find(t);return r.length==0?null:r.length==1&&r.is(":not([type=checkbox]):not([type=radio])")?r[0]:r.get()};this.PostAutoSuggest=function(){for(var e in this.AutoSuggests){var t=this.AutoSuggests[e].$input;if(t&&t.is(":focus")){t.blur();break}}};this.UpdateOpts=function(e){if(e===$rowindex$)return;var t=[],r=this.GetForm();this.CompileTemplates();for(var i in this.Lists){var n=this.Lists[i].ParentFields.slice();var o=this.Lists[i].Ajax;if(a.isValue(e)){i=i.replace(/^x_/,"x"+e+"_");for(var s=0,l=n.length;s<l;s++)n[s]=n[s].replace(/^x_/,"x"+e+"_")}if(a.isBoolean(o)){var d=[];for(var s=0,l=n.length;s<l;s++)d[d.length]=ew_GetOptValues(n[s],r);t[t.length]=[i,d,o,false]}else{ew_UpdateOpt.call(this,i,n,null,false)}}for(var s=0,u=t.length;s<u;s++)a.later(EW_AJAX_DELAY*s,this,ew_UpdateOpt,t[s])};this.CreateAutoSuggest=function(e){var t=this,r=e.id;e.form=this;var i=a.extend({},ewAutoSuggestSettings,e);var n=r.replace(/^[xy](\d*|\$rowindex\$)_/,"x_");var o=t.AutoSuggests[n],s=t.AutoSuggests[r];if(a.isObject(o)&&!(s instanceof ew_AutoSuggest))i=a.extend(i,o);t.AutoSuggests[r]=new ew_AutoSuggest(i)};this.CreateEditor=function(e){var t=this.GetForm();a(t.elements).filter("textarea.editor").each(function(t,r){var i=a(r).data("editor");if(!i||i.active||i.name.indexOf("$rowindex$")>-1||e&&i.name!=e)return true;i.create();if(e)return false})};this.UpdateTextArea=function(e){var t=this.GetForm();a(t.elements).filter("textarea.editor").each(function(t,r){var i=a(r).data("editor");if(!i||e&&i.name!=e)return true;i.save();if(e)return false})};this.DestroyEditor=function(e){var t=this.GetForm();a(t.elements).filter("textarea.editor").each(function(t,r){var i=a(r).data("editor");if(!i||e&&i.name!=e)return true;i.destroy();if(e)return false})};this.OnError=function(e,t){return ew_OnError(this,e,t)};this.InitUpload=function(){var e=this.GetForm();a(e.elements).filter("input:file:not([name*='$rowindex$'])").each(function(e){a.later(EW_AJAX_DELAY*e,null,ew_Upload,this)})};this.SetupFilters=function(e,t){var r=this,i=this.ID,n=this.FilterList?this.FilterList.data:null,o=a(".ewSaveFilter[data-form="+i+"]"),s=a(".ewDeleteFilter[data-form="+i+"]"),l=s.parent("li").toggleClass("dropdown-submenu",!!t.length).toggleClass("disabled",!t.length),d=o.parent("li").toggleClass("disabled",!n),u=a(e.target);var f=function(e,t){if(EW_SEARCH_FILTER_OPTION=="Client"){a.localStorage.set(e+"_filters",t)}else if(EW_SEARCH_FILTER_OPTION=="Server"){var i={ajax:"savefilters",filters:JSON.stringify(t),token:EW_TOKEN};a("body").css("cursor","wait");a.ajax(ew_CurrentPage(),{type:"POST",dataType:"json",data:i}).done(function(e){if(e[0]&&e[0].success)r.FilterList.filters=t}).always(function(){a("body").css("cursor","default")})}};d.off("click.ew").on("click.ew",function(e){if(d.hasClass("disabled"))return false;ew_Prompt(ewLanguage.Phrase("EnterFilterName"),function(e){t[t.length]=[e,n];f(i,t)},true)}).prevAll().remove();s.next("ul.dropdown-menu").remove();if(t.length){$menu=s.closest("ul.dropdown-menu");$submenu=a("<ul class='dropdown-menu'></ul>");for(var c in t){if(!a.isArray(t[c]))continue;a("<li><a data-index='"+c+"' href='#'>"+t[c][0]+"</a></li>").on("click",function(e){var r=a(this).find("a[data-index]").data("index");ew_Prompt(ewLanguage.Phrase("DeleteFilterConfirm").replace("%s",t[r][0]),function(e){if(e){t.splice(r,1);f(i,t)}})}).appendTo($submenu);a("<li><a class='ewFilterList' data-index='"+c+"' href='#'>"+t[c][0]+"</a></li>").insertBefore(d).on("click",function(e){var r=a(this).find("a[data-index]").data("index");a("<form>").attr({method:"post",action:ew_CurrentPage()}).append(a("<input type='hidden'>").attr({name:"cmd",value:"resetfilter"}),a("<input type='hidden'>").attr({name:"token",value:EW_TOKEN}),a("<input type='hidden'>").attr({name:"filter",value:JSON.stringify(t[r][1])})).appendTo("body").submit()})}a("<li class='divider'></li>").insertBefore(d);l.append($submenu)}};this.Init=function(){var e=this,t=this.GetForm(),r=a(t);if(EW_SEARCH_FILTER_OPTION=="Client"&&window.localStorage||EW_SEARCH_FILTER_OPTION=="Server"&&EW_IS_LOGGEDIN&&!EW_IS_SYS_ADMIN&&EW_CURRENT_USER_NAME!=""){a(".ewFilterOption."+this.ID+" .ewButtonDropdown").on("show.bs.dropdown",function(t){var r=[];if(EW_SEARCH_FILTER_OPTION=="Client")r=a.localStorage.get(e.ID+"_filters")||[];else if(EW_SEARCH_FILTER_OPTION=="Server")r=e.FilterList&&e.FilterList.filters?e.FilterList.filters:[];var i=a.grep(r,function(e){if(a.isArray(e)&&e.length==2)return e});e.SetupFilters(t,i)})}else a(".ewFilterOption").hide();if(!t)return;this.CompileTemplates();var i=/s(ea)?rch$/.test(this.ID);if(i&&this.InitSearchPanel&&!ew_HasFormData(t))a("#"+this.ID+"_SearchPanel").removeClass("in");a(".ewSearchToggle[data-form="+this.ID+"]").on("click.bs.button",function(){a("#"+a(this).data("form")+"_SearchPanel").collapse("toggle")});if(!a(".ewTable .ewSearchOperator").text().trim())a(".ewTable .ewSearchOperator").parent("td").hide();if(i){a(".ewHighlight[data-form="+this.ID+"]").on("click.bs.button",function(){a("span."+a(this).data("name")).toggleClass("ewHighlightSearch")})}if(i){r.find("select[id^=z_]").each(function(){var e=a(this).change();if(e.val()!="BETWEEN")r.find("#w_"+this.id.substr(2)).change()})}if(this.MultiPage)this.MultiPage.Render();this.CreateEditor();this.UpdateOpts();this.InitUpload();if(!EW_RESET_HEIGHT&&r.is("form")){if(r.width()>a(".content").width())a(document).trigger("overflow",[r])}if(this.$Element.is("form")){r.submit(function(t){return e.Submit()});r.find("[data-field], .ewPriv").change(function(){if(EW_CONFIRM_CANCEL)e.Modified=true});r.find("#btnCancel[data-href]").click(function(){e.UpdateTextArea();e.PostAutoSuggest();var r=a(this).data("href");if(e.Modified&&ew_HasFormData(t)){ew_Prompt(ewLanguage.Phrase("ConfirmCancel"),function(e){if(e)window.location=r})}else{window.location=r}})}this.$Element.data("form",this)};ewForms[this.ID]=this}function ew_Prompt(e,t,a){var r=jQuery,i=r("#ewPrompt"),n=i.find(".modal-body").empty();if(a){n.append('<div class="form-group">'+'<label class="control-label">'+e+"</label>"+'<input type="text" class="form-control" style="display: block; width: 100%;"></div>');$input=n.find("input").click(function(){$input.parent().removeClass("has-error")});i.find(".modal-footer .btn-primary").off().click(function(e){var a=r.trim($input.val());if(a==""){$input.parent().addClass("has-error");$input[0].focus()}else{i.modal("hide");if(r.isFunction(t))t(a)}});i.on("shown.bs.modal",function(e){$input[0].focus()})}else{n.append("<div>"+e+"</div>");i.find(".modal-footer .btn-primary").off().click(function(e){i.modal("hide");if(r.isFunction(t))t(true)});if(t){i.find(".modal-footer .btn-default").off().click(function(e){i.modal("hide");if(r.isFunction(t))t(false)}).show()}else{i.find(".modal-footer .btn-default").hide()}}i.modal("show")}function ew_GetForm(e){var t=jQuery,a=t(e),r=a.closest(".ewForm");if(!r[0])r=a.closest(".ewGrid, .ewMultiColumnGrid").find(".ewForm");return r[0]}function ew_HasFormData(e){var t=jQuery,a="[name^=x_][value!='{value}'],[name^=y_],[name^=z_],[name^=w_],[name=psearch]",r=t(e).find(a).filter(":enabled").get();for(var i=0,n=r.length;i<n;i++){var o=r[i];if(/^(z|w)_/.test(o.name)){if(/^IS/.test(t(o).val()))return true}else if(o.type=="checkbox"||o.type=="radio"){if(o.checked)return true}else if(o.type=="select-one"||o.type=="select-multiple"){if(!!t(o).val())return true}else if(o.type=="text"||o.type=="hidden"||o.type=="textarea"){if(o.value)return true}}return false}function ew_SetSearchType(e,t){var a=jQuery,r=a(e),i=r.closest("form"),n="";i.find("input[name=psearchtype]").val(t||"");if(t=="="){n=ewLanguage.Phrase("QuickSearchExactShort")}else if(t=="AND"){n=ewLanguage.Phrase("QuickSearchAllShort")}else if(t=="OR"){n=ewLanguage.Phrase("QuickSearchAnyShort")}else{n=ewLanguage.Phrase("QuickSearchAutoShort")}i.find("#searchtype").html(n+(n?"&nbsp;":""));r.closest("ul").find("li").removeClass("active");r.closest("li").addClass("active");return false}function ew_UpdateOpt(e,t,a,r){var i=jQuery,n=this,o=i(this);var s=function(){if(o.queue().length){o.dequeue()}else{i(document).trigger("updatedone",[{source:n,target:e}])}};var l=this.$Element?this.$Element[0]:this.form?this.form:null;if(!l)return s();var d=this.Form?this:ewForms[l.id];if(!d)return s();var u=i.makeArray(arguments);if(this.form&&i.isUndefined(e))e=ewForms(this).Lists[this.name.replace(/^(sv_)?[xy]\d*_/,"x_")].ChildFields.slice();if(!e||i.isArray(e)&&e.length==0)return s();if(i.isArray(e)&&i.isString(e[0])){for(var f=0,c=e.length;f<c;f++){var p=e[f].split(" ");if(p.length==1&&n.form){var h=ew_GetId(n,false).match(/^([xy]\d*_)/);if(h)e[f]=e[f].replace(/^([xy]\d*_)/,h[1])}var g=ew_GetElements(e[f],l),_=[];if(p.length==2&&i.isArray(g)){var w=i(g);w.each(function(){if(!_.includes(this.name)){_[_.length]=this.name;var e=w.filter("[name='"+this.name+"']"),s=e.attr("type");if(s=="radio"||s=="checkbox")o.queue(i.proxy(ew_UpdateOpt,n,e.get(),t,a,r));else o.queue(i.proxy(ew_UpdateOpt,n,e[0],t,a,r))}})}else{o.queue(i.proxy(ew_UpdateOpt,n,g,t,a,r))}}var v=ewForms(this).Lists[this.name.replace(/^[xy]\d*_/,"x_")];if(v&&v.AutoFill)o.queue(function(){ew_AutoFill(n)});return s()}if(i.isString(e))e=ew_GetElements(e,l);if(!e||i.isArray(e)&&e.length==0)return s();var p=ew_GetOptValues(e);var m=ew_GetId(e,false);if(!m)return s();var E="",b="",h=m.match(/^([xy])(\d*)_/);if(h){E=h[1];b=h[2]}var S=m.replace(/^([xy])(\d*)_/,"x_");var y=[];var A=ew_GetForm(e);if(!A||!A.id)return s();var T=ewForms[A.id];if(!T)return s();if(i.isUndefined(t)){t=T.Lists[S].ParentFields.slice();if(b!=""){for(var f=0,c=t.length;f<c;f++){var L=t[f].split(" ");if(L.length==1)t[f]=t[f].replace(/^x_/,"x"+b+"_")}}else if(E=="y"){}}if(i.isArray(t)&&t.length>0){if(i.isArray(t[0])){y=t}else if(i.isString(t[0])){for(var f=0,c=t.length;f<c;f++)y[y.length]=ew_GetOptValues(t[f],l)}}if(!ew_IsAutoSuggest(e))ew_ClearOpt(e);var x=function(t){for(var a=0,n=t.length;a<n;a++){var o={data:t[a],parents:y,valid:true,name:ew_GetId(e),form:A};i(document).trigger("addoption",[o]);if(o.valid)ew_NewOpt(e,t[a],A)}if(!e.options&&e.length){ew_RenderOpt(e);e=ew_GetElements(m,A)}ew_SelectOpt(e,p);if(r!==false){if(!e.options&&e.length)i(e).first().triggerHandler("click");else i(e).first().change()}};if(i.isUndefined(a))a=T.Lists[S].Ajax;if(!i.isBoolean(a)){var O=T.Lists[S].Options;x(O);if(/s(ea)?rch$/.test(l.id)&&E=="x"){u[0]=m.replace(/^x_/,"y_");ew_UpdateOpt.apply(this,u)}return s()}else{var I=ew_GetId(e),C=T.Lists[S].Data;if(!C)return s();C+="&ajax=updateoption&name="+I;if(ew_IsAutoSuggest(e)&&this.Form)C+="&v0="+(p[0]?encodeURIComponent(p[0]):ew_Random());else if(ew_IsModalLookup(e))C+="&v0="+(p[0]?encodeURIComponent(i(e).data("multiple")?p.join(EW_LOOKUP_FILTER_VALUE_SEPARATOR):p[0]):ew_Random());for(var f=0,P=y.length;f<P;f++)C+="&v"+(f+1)+"="+encodeURIComponent(y[f].join(EW_LOOKUP_FILTER_VALUE_SEPARATOR));C+="&token="+EW_TOKEN;i.ajax(EW_LOOKUP_FILE_NAME,{type:"POST",dataType:"json",data:C,async:a,success:function(e){x(e||[])}}).always(function(){s()});if(/s(ea)?rch$/.test(l.id)&&E=="x"){u[0]=m.replace(/^x_/,"y_");ew_UpdateOpt.apply(this,u)}}}function ew_Language(e){this.obj=e;this.Phrase=function(e){return this.obj[e.toLowerCase()]}}function ew_ApplyTemplate(e,t,a,r,i){var n=jQuery,o={data:i||{},id:e,template:t,filename:a,export:r,enabled:true};if(n.views&&t&&($tmpl=n("#"+t))[0]){if(!$tmpl.attr("type"))$tmpl.attr("type","text/html");n(document).trigger("rendertemplate",[o]);if(o.enabled)n("#"+e).html($tmpl.render(o.data))}if(r&&r!="print"){n(function(){var t=n("meta[http-equiv='Content-Type']");var a="<html><head>";var i=n("#"+e);if(t[0])a+="<meta http-equiv='Content-Type' content='"+t.attr("content")+"'>";if(r=="pdf"){a+="<link rel='stylesheet' type='text/css' href='"+EW_PDF_STYLESHEET_FILENAME+"'>";if(i.children(0).is("div[id^=ct_]"))i=i.children(0)}else{a+="<style>"+n.ajax({async:false,type:"GET",url:EW_PROJECT_STYLESHEET_FILENAME}).responseText+"</style>"}a+="</"+"head><body>"+i.html()+"</body></html>";var s=ew_CurrentPage();var l={customexport:r,data:a,filename:o.filename};if(r=="email"){var d=window.location.search.replace(/^\?/,"")+"&"+n.param(l)+"&token="+EW_TOKEN;n.post(s,d,function(e){ew_ShowMessage(e)})}else{ew_FileDownload(s,l)}})}}function ew_RenderTemplate(e,t){var a=jQuery,r=e&&e.render?e:a(e);if(!r.render)return;var i={$template:r,data:t};a(document).trigger("rendertemplate",[i]);var n=r.render(i.data),o=i.$template.data("method"),s=i.$template.data("target");if(n&&o&&s)a(n)[o](s);else if(n&&!o&&s)a(s).html(n);else if(n&&!o&&!s)r.parent().append(n);return n}function ew_RenderJsTemplates(e){var t=jQuery,a={},r=e&&e.target?e.target:document;t(r).find(".ewJsTemplate").sort(function(e,a){e=parseInt(t(e).data("seq"),10)||0;a=parseInt(t(a).data("seq"),10)||0;if(e>a){return 1}else if(e<a){return-1}else{return 0}}).each(function(e){var a=t(this),r=a.data("name"),i=a.data("data");if(i&&t.isString(i))i=ewVar[i]||window[i];if(r){if(!t.render[r]){t.templates(r,a.text());ew_RenderTemplate(a,i)}}else{ew_RenderTemplate(a,i)}})}function ew_ShowTemplates(e){var t=jQuery;t("script"+(e?"."+e:"")+"[type='text/html']").each(function(){$scr=t(this);if(/^\s*(<(td|th)[\s\S]*>[\s\S]*<\/\2>)\s*$/i.test($scr.html())){$scr.next().before(RegExp.$1)}else{t(this).after(t("<span></span>").addClass($scr.attr("class")).html($scr.html()))}$scr.closest(".ewTable, .ewViewTable, .ewGrid").removeClass("hidden").show()})}function ew_ConvertToBool(e){return e&&["1","y","t"].includes(e.toLowerCase())}function ew_ValueChanged(e,t,a,r){var i=jQuery;var n=ew_GetElements("x"+t+"_"+a,e);var o=ew_GetElement("o"+t+"_"+a,e);var s=ew_GetElement("fn_x"+t+"_"+a,e);if(!o&&(!n||i.isArray(n)&&n.length==0))return false;var l=function(e){return ew_GetOptValues(e).join(",")};if(o&&n){if(r){if(ew_ConvertToBool(l(o))===ew_ConvertToBool(l(n)))return false}else{var d=l(o);var u=s?l(s):l(n);if(d==u)return false}}return true}function ew_Get(e,t){t=t||window.location.search;var a=/(?:\?|&)([^&=]+)=?([^&]*)/g;var r=/\+/g;var i=function(e){return decodeURIComponent(e.replace(r," "))};var n={},o;while(o=a.exec(t)){var s=i(o[1]),l=i(o[2]);if(s.substring(s.length-2)==="[]")s=s.substring(0,s.length-2);(n[s]||(n[s]=[])).push(l)}return n[e]}function ew_SetLanguage(e){var t=jQuery,a=t(e),r=a.val()||a.data("language");if(!r)return;var i=window.location.href;if(window.location.search){var n=window.location.search;var o={};n.replace(/(?:\?|&)([^&=]*)=?([^&]*)/g,function(e,t,a){if(t)o[t]=a});o["language"]=encodeURIComponent(r);var s="?";for(var l in o)s+=l+"="+o[l]+"&";s=s.substr(0,s.length-1);var d=i.lastIndexOf(window.location.search);i=i.substr(0,d)+s}else{if(window.location.hash)i=i.split("#")[0]+"?language="+encodeURIComponent(r)+"#"+i.split("#")[1];else i+="?language="+encodeURIComponent(r)}window.location=i}function ew_SubmitAction(e,t){var a=jQuery,r=e.target||e.srcElement,i=a(r),n=t.f||i.closest("form")[0]||CurrentForm,o=a(n),s=t.key,l=t.action,d=t.url||ew_CurrentPage(),u=t.msg,f=t.data,c=t.success,p=!t.method||ew_SameText(t.method[0],"p"),h=!t.select&&!t.key||t.select&&ew_SameText(t.select[0],"m");if(h&&!o[0])return;if(h&&!ew_KeySelected(o[0])){ew_Prompt('<p class="text-danger">'+ewLanguage.Phrase("NoRecordSelected")+"</p>");return}var g=function(e){ew_ShowMessage(e)};var _=function(){if(p){if(l)a("<input>").attr({type:"hidden",name:"useraction",value:l}).appendTo(o);if(a.isObject(f)){for(var e in f)a("<input>").attr({type:"hidden",name:e,value:f[e]}).appendTo(o)}if(!h&&a.isObject(s)){for(var e in s)a("<input>").attr({type:"hidden",name:e,value:s[e]}).appendTo(o)}o.prop("action",d).submit();if(l)o.find("input[type=hidden][name=useraction]").remove()}else{f=a.isObject(f)?a.param(f):a.isString(f)?f:"";f+=(f?"&":"")+"token="+EW_TOKEN;if(l)f+="&useraction="+l+"&ajax="+l;if(h)f+="&"+o.find("input[name='key_m[]']:checked").serialize();else if(s)f+="&"+(a.isObject(s)?a.param(s):s);if(c&&a.isString(c))c=window[c];if(!a.isFunction(c))c=g;a.post(d,f,c)}};if(u){ew_Prompt(u,function(e){if(e)_()})}else{_()}}function ew_Export(e,t,a,r,i,n){if(!e)return;var o=jQuery,s=o(e),l=s.attr("target"),d=s.attr("action");var u=i&&s.find("input[type=checkbox][name='key_m[]']")[0];if(u&&!ew_KeySelected(e)){ew_Alert(ewLanguage.Phrase("NoRecordSelected"));return}if(r){o("iframe.ewExport").remove();if(a=="email")t+=("&"+o(n).serialize()).replace(/&export=email/i,"");if(u){o("<iframe>").attr("name","ewExportFrame").addClass("ewExport hide").appendTo(o("body"));try{s.append(o("<input type='hidden'>").attr({name:"custom",value:"1"})).attr({action:t,target:"ewExportFrame"}).find("input[name=exporttype]").val(a).end().submit()}finally{s.attr({target:l||"",action:d}).find("input[name=custom]").remove()}}else{o("<iframe>").attr({name:"ewExportFrame",src:t}).addClass("ewExport hide").appendTo(o("body"))}}else{s.find("input[name=exporttype]").val(a);if(a=="print")s.submit();else ew_FileDownload(e.action,s.serialize())}}function ew_RemoveSpaces(e){return/^(<(p|br)\/?>(&nbsp;)?(<\/p>)?)?$/i.test(e.replace(/\s/g,""))?"":e}function ew_IsHiddenTextArea(e){var t=jQuery,a=t(e);return e&&a.is(":hidden")&&a.data("editor")}function ew_IsModalLookup(e){var t=jQuery,a=t(e);return e&&a.is(":hidden")&&a.data("lookup")}function ew_IsAutoSuggest(e){var t=jQuery,a=t(e);return a[0]&&a.is(":hidden")&&a.data("autosuggest")}function ew_GetAutoSuggest(e){return ewForms(e).AutoSuggests[e.id]}function ew_Alert(e,t,a){var r=jQuery;if(EW_IS_MOBILE){alert(e);if(t)r.later(100,null,t)}else{var i=r("#ewMsgBox");i.find(".modal-body").html('<p class="text-'+(a||"danger")+'">'+e+"</p>");i.modal("show");if(t)i.off("hidden.bs.modal").on("hidden.bs.modal",t)}}function ew_OnError(e,t,a){if(t.jquery){var r=t.attr("type");t=r=="checkbox"||r=="radio"?t.get():t[0]}ew_Alert(a,function(){ew_SetFocus(t)});if(e){if(e.MultiPage){e.MultiPage.GotoPageByElement(t)}else if(e.$Element.is("div")){var i=e.$Element.closest(".tab-pane");if(i[0]&&!i.hasClass("active"))i.closest(".tabbable, .nav-tabs-custom").find("a[data-toggle=tab][href='#"+i.attr("id")+"']").click()}}return false}function ew_SetFocus(e){if(!e)return;var t=jQuery,a=t(e);if(ew_IsHiddenTextArea(e)){return a.data("editor").focus()}else if(!e.options&&e.length){e=a.filter("[value!='{value}']")[0]}else if(ew_IsAutoSuggest(e)){e=ew_GetAutoSuggest(e).input}var r=a.closest(".form-group,[id^='el_']").addClass("has-error");if(ew_IsModalLookup(e)){r.find(":button").on("click",function(){r.removeClass("has-error")})}else{if(e.type=="checkbox"||e.type=="radio"){a.filter("[value!='{value}']").focus().one("click keypress keyup",function(){r.removeClass("has-error")})}else{t(e).focus().select().one("click keypress keyup",function(){r.removeClass("has-error")})}}}function ew_HasValue(e){
return ew_GetOptValues(e).join("")!=""}function ew_Sort(e,t,a){if(a==2&&e.ctrlKey)t+="&ctrl=1";location=t;return true}function ew_ConfirmDelete(e){ew_ClickDelete(e);ew_Prompt(ewLanguage.Phrase("DeleteConfirmMsg"),function(t){t&&e.href?window.location=e.href:ew_ClearDelete(e)});return false}function ew_KeySelected(e){return jQuery(e).find("input[type=checkbox][name='key_m[]']:checked",e).length>0}function ew_SelectAllKey(e){ew_SelectAll(e);var t=jQuery,a=t(e).closest("."+EW_TABLE_CLASSNAME)[0];if(!a)return;t(a.tBodies).each(function(){t(this.rows).each(function(a,r){var i=t(r);if(i.is(":not(."+EW_ITEM_TEMPLATE_CLASSNAME+"):not(."+EW_TABLE_PREVIEW_ROW_CLASSNAME+")")){i.data({selected:e.checked,checked:e.checked});ew_SetColor(a,r)}})})}function ew_SelectAll(e){if(!e||!e.form)return;$(e.form.elements).filter("input[type=checkbox][name^="+e.name+"_], [type=checkbox][name="+e.name+"]").not(e).prop("checked",e.checked)}function ew_UpdateSelected(e){return jQuery(e).find("input[type=checkbox][name^=u_]:checked").length>0}function ew_AddClass(e,t){var a=jQuery,r=a(e);if(!r.data("bgcolor"))r.data("bgcolor",r.css("backgroundColor"));if(!r.data("color"))r.data("color",r.css("color"));r.css("backgroundColor","").css("color","").addClass(t)}function ew_RemoveClass(e,t){var a=jQuery,r=a(e).removeClass(t);if(r.data("bgcolor"))r.css("backgroundColor",r.data("bgcolor"));if(r.data("color"))r.css("color",r.data("color"))}function ew_UpdateRow(e,t){var a=jQuery,r=a(e),i=r.data("rowindex");if(!e||!a.isFunction(t))return;t(-1,e);if(i){r.prevUntil("tr[data-rowindex!='"+i+"']").each(t);r.nextUntil("tr[data-rowindex!='"+i+"']").each(t)}}function ew_MouseOver(e){var t=jQuery,a=t(this);if(!a.data("selected")&&![EW_ROWTYPE_ADD,EW_ROWTYPE_EDIT].includes(a.data("rowtype"))){var r=a.closest("."+EW_TABLE_CLASSNAME);if(!r[0])return;ew_UpdateRow(this,function(e,a){t(a).addClass(r.data("rowhighlightclass")||EW_TABLE_HIGHLIGHT_ROW_CLASSNAME)})}}function ew_MouseOut(e){var t=jQuery,a=t(this);if(!a.data("selected")&&![EW_ROWTYPE_ADD,EW_ROWTYPE_EDIT].includes(a.data("rowtype")))ew_UpdateRow(this,ew_SetColor)}function ew_Click(e){var t=jQuery,a=t(this),r=a.closest("."+EW_TABLE_CLASSNAME)[0],i=t(e.target);if(!r||i.hasClass("btn")||i.hasClass("ewPreviewRowBtn")||i.is(":input"))return;if(!a.data("checked")){var n=a.data("selected");ew_ClearSelected(r);ew_UpdateRow(this,function(e,a){t(a).data("selected",!n);ew_SetColor(e,a)})}}function ew_SetColor(e,t){var a=jQuery,r=a(t),i=r.closest("."+EW_TABLE_CLASSNAME);if(!i[0])return;if(r.data("selected")){r.removeClass(i.data("rowhighlightclass")||EW_TABLE_HIGHLIGHT_ROW_CLASSNAME).removeClass(i.data("roweditclass")||EW_TABLE_EDIT_ROW_CLASSNAME).addClass(i.data("rowselectclass")||EW_TABLE_SELECT_ROW_CLASSNAME)}else if([EW_ROWTYPE_ADD,EW_ROWTYPE_EDIT].includes(r.data("rowtype"))){r.removeClass(i.data("rowselectclass")||EW_TABLE_SELECT_ROW_CLASSNAME).removeClass(i.data("rowhighlightclass")||EW_TABLE_HIGHLIGHT_ROW_CLASSNAME).addClass(i.data("roweditclass")||EW_TABLE_EDIT_ROW_CLASSNAME)}else{r.removeClass(i.data("rowselectclass")||EW_TABLE_SELECT_ROW_CLASSNAME).removeClass(i.data("roweditclass")||EW_TABLE_EDIT_ROW_CLASSNAME).removeClass(i.data("rowhighlightclass")||EW_TABLE_HIGHLIGHT_ROW_CLASSNAME)}}function ew_ClearSelected(e){var t=jQuery;t(e.rows).each(function(e,a){var r=t(a);if(!r.data("checked")&&r.data("selected")){r.data("selected",false);ew_SetColor(e,a)}})}function ew_ClearDelete(e){var t=jQuery,a=t(e),r=a.closest("."+EW_TABLE_CLASSNAME)[0];if(!r)return;ew_UpdateRow(a.closest(".ewTable > tbody > tr")[0],function(e,a){var r=t(a);r.data("selected",r.data("checked"))})}function ew_ClickDelete(e){var t=jQuery,a=t(e),r=a.closest("."+EW_TABLE_CLASSNAME)[0];if(!r)return;ew_ClearSelected(r);ew_UpdateRow(a.closest(".ewTable > tbody > tr")[0],function(e,a){t(a).data("selected",true);ew_SetColor(e,a)})}function ew_StopPropagation(e){if(e.stopPropagation){e.stopPropagation()}else{e.cancelBubble=true}}function ew_ClickMultiCheckbox(e){var t=jQuery,a=e.target||e.srcElement,r=t(a),i=r.closest("."+EW_TABLE_CLASSNAME)[0];if(!i)return;ew_ClearSelected(i);ew_UpdateRow(r.closest(".ewTable > tbody > tr")[0],function(e,r){t(r).data("checked",a.checked).data("selected",a.checked).find("input[type=checkbox][name='key_m[]']").each(function(){if(this!=a)this.checked=a.checked});ew_SetColor(e,r)});ew_StopPropagation(e)}function ew_SetupTable(e,t,a){var r=jQuery,i=r(t),n=r(t.rows);if(!t||!t.rows||!a&&i.data("isset")||t.tBodies.length==0)return;var o=n.filter("[data-rowindex=1]").length||n.filter("[data-rowindex=0]").length||1;var s=n.filter(":not(."+EW_ITEM_TEMPLATE_CLASSNAME+")").each(function(){r(this.cells).removeClass(EW_TABLE_LAST_ROW_CLASSNAME).last().addClass(EW_TABLE_LAST_COL_CLASSNAME)}).get();var l=i.parentsUntil(".ewGrid",".table-responsive")[0];if(s.length){for(var d=1;d<=o;d++){var u=s[s.length-d];r(u.cells).each(function(){if(this.rowSpan==d)r(this).addClass(EW_TABLE_LAST_ROW_CLASSNAME).toggleClass(EW_TABLE_BORDER_BOTTOM_CLASSNAME,!!l&&l.clientHeight>t.offsetHeight)})}}var f=i.closest("form")[0];var c=f&&r(f.elements).filter("input#a_list:not([value^=grid])").length>0;r(t.tBodies[t.tBodies.length-1].rows).filter(":not(."+EW_ITEM_TEMPLATE_CLASSNAME+"):not(."+EW_TABLE_PREVIEW_ROW_CLASSNAME+")").each(function(e){var t=r(this);if(c&&!t.data("isset")){if([EW_ROWTYPE_ADD,EW_ROWTYPE_EDIT].includes(t.data("rowtype")))t.on("mouseover",function(){this.edit=true}).addClass(EW_TABLE_EDIT_ROW_CLASSNAME);t.on("mouseover",ew_MouseOver).on("mouseout",ew_MouseOut).on("click",ew_Click);t.data("isset",true)}var a=e%(2*o)<o;t.toggleClass(EW_TABLE_ROW_CLASSNAME,a).toggleClass(EW_TABLE_ALT_ROW_CLASSNAME,!a)});ew_SetupGrid(e,i.closest("."+EW_GRID_CLASSNAME)[0],a);i.data("isset",true)}function ew_SetupGrid(e,t,a){var r=jQuery,i=r(t);if(!t||!a&&i.data("isset"))return;var n=i.find("table.ewMultiColumnTable").length,o;if(n){o=i.find("td[data-rowindex]").length}else{o=i.find("table."+EW_TABLE_CLASSNAME+" > tbody:first > tr:not(."+EW_TABLE_PREVIEW_ROW_CLASSNAME+", ."+EW_ITEM_TEMPLATE_CLASSNAME+")").length}if(o==0&&!i.find(".ewGridUpperPanel, .ewGridLowerPanel")[0])i.hide();i.find(".ewGridUpperPanel, .ewGridLowerPanel").each(function(){var e=r(this),t=e.children().map(function(){return r(this).html()}).get().join("");if(r.trim(t)=="")e.remove()});if(!i.find(".ewGridUpperPanel:visible")[0])i.css({"border-top-left-radius":0,"border-top-right-radius":0});if(!i.find(".ewGridLowerPanel:visible")[0])i.css({"border-bottom-left-radius":0,"border-bottom-right-radius":0});i.data("isset",true)}function ew_AddGridRow(e){var t=jQuery,a=t(e).closest("."+EW_GRID_CLASSNAME),r=a.find("table."+EW_TABLE_CLASSNAME).last(),i=r.parent("div"),n=r.find("tr."+EW_ITEM_TEMPLATE_CLASSNAME);if(!e||!a[0]||!r[0]||!n[0])return;var o=t(r[0].rows).last();r.find("td."+EW_TABLE_LAST_ROW_CLASSNAME).removeClass(EW_TABLE_LAST_ROW_CLASSNAME);var s=n.clone(true,true).removeClass(EW_ITEM_TEMPLATE_CLASSNAME);var l=a.find("div.ewForm[id^=f][id$=grid]");if(!l[0])l=a.find("form.ewForm[id^=f][id$=list]");var d=l.is("div")?"_"+l.attr("id"):"";var u=l.find("#key_count"+d);var f=parseInt(u.val(),10)+1;s.attr({id:"r"+f+s.attr("id").substring(2),"data-rowindex":f});var c=n.find("script:contains('$rowindex$')");s.children("td").each(function(){t(this).find("*").each(function(){t.each(this.attributes,function(e,t){t.value=t.value.replace(/\$rowindex\$/g,f)})})});s.find(".ewIcon").closest("a, button").removeData("bs.tooltip").tooltip({container:"body",placement:"bottom",trigger:"hover"});u.val(f).after(t("<input>").attr({type:"hidden",id:"k"+f+"_action"+d,name:"k"+f+"_action"+d,value:"insert"}));o.after(s);c.each(function(){ew_AddScript(this.text.replace(/\$rowindex\$/g,f))});var p=l.data("form");if(p){p.CreateEditor();p.InitUpload()}ew_SetupTable(-1,r[0],true);i.scrollTop(i[0].scrollHeight)}function ew_DeleteGridRow(e,t){var a=jQuery,r=a(e).tooltip("hide").removeData("bs.tooltip"),i=r.closest("."+EW_GRID_CLASSNAME+", ."+EW_MULTI_COLUMN_GRID_CLASSNAME),n=r.closest("tr, div[data-rowindex]"),o=n.closest("."+EW_TABLE_CLASSNAME);if(!e||!i[0]||!n[0])return;var s=parseInt(n.data("rowindex"),10);var l=i.find("div.ewForm[id^=f][id$=grid]");if(!l[0])l=i.find("form.ewForm[id^=f][id$=list]");var d=l.data("form");if(!l[0]||!d)return;var u=l.is("div")?"_"+l.attr("id"):"";var f="#key_count"+u;var c=l.find(f);var p=function(){n.remove();if(i.is("."+EW_GRID_CLASSNAME))ew_SetupTable(-1,o[0],true);if(s>0){var e=l.find("#k"+s+"_action"+u);if(e[0]){e.val(e.val()=="insert"?"insertdelete":"delete")}else{l.find(f).after(a("<input>").attr({type:"hidden",id:"k"+s+"_action"+u,name:"k"+s+"_action"+u,value:"delete"}))}}};if(a.isFunction(d.EmptyRow)&&d.EmptyRow(t)){p()}else{ew_Prompt(ewLanguage.Phrase("DeleteConfirmMsg"),function(e){if(e)p()})}return false}function ew_HtmlEncode(e){var t=String(e);t=t.replace(/&/g,"&amp");t=t.replace(/\"/g,"&quot;");t=t.replace(/</g,"&lt;");t=t.replace(/>/g,"&gt;");return t}function ew_ClearForm(e){var t=jQuery;t(e).find("[id^=x_],[id^=y_],[id^=n_]").each(function(){if(this.type=="checkbox"||this.type=="radio"){this.checked=false}else if(this.type=="select-one"){this.selectedIndex=0}else if(this.type=="select-multiple"){t(this).find("option").prop("selected",false)}else if(this.type=="text"||this.type=="textarea"||this.type=="hidden"&&ew_IsAutoSuggest(this)){this.value="";if(this.type=="hidden")ew_GetAutoSuggest(this).input.value=""}})}function ew_MultiPage(e){var t=jQuery,a=this;this.$Form=null;this.FormID=e;this.PageIndex=1;this.MaxPageIndex=0;this.MinPageIndex=0;this.PageIndexes=[];this.$Pages=null;this.isTab=false;this.isCollapse=false;this.LastPageSubmit=false;this.HideDisabledButton=false;this.HideInactivePages=false;this.LockTabs=false;this.HideTabs=false;this.ShowPagerTop=false;this.ShowPagerBottom=false;this.PagerTemplate='<nav><ul class="pager"><li class="previous ewPrev"><a href="#"><span class="icon-prev"></span> {Prev}</a></li><li class="next ewNext"><a href="#">{Next} <span class="icon-next"></span></a></li></ul></nav>';var r=function(e){e.preventDefault()};var i=["LastPageSubmit","HideDisabledButton","HideInactivePages","LockTabs","HideTabs","ShowPagerTop","ShowPagerBottom","PagerTemplate"];this.Set=function(){if(arguments.length==1&&t.isObject(arguments[0])){var e=arguments[0];for(var a in e){if(i.includes(a))this[a]=e[a]}}};this.Init=function(){var e=this.PagerTemplate.replace(/\{prev\}/i,ewLanguage.Phrase("Prev")).replace(/\{next\}/i,ewLanguage.Phrase("Next"));if(this.isTab){if(this.ShowPagerTop)this.$Pages.closest(".tabbable, .nav-tabs-custom").before(e);if(this.ShowPagerBottom)this.$Pages.closest(".tabbable, .nav-tabs-custom").after(e);this.$Form.find(".ewPrev").click(function(e){a.$Pages.off("show.bs.tab",r).parent(".active").prevAll(":not(.ewHidden):not(.ewDisabled)").first().find("[data-toggle=tab]").click();return false});this.$Form.find(".ewNext").click(function(e){a.$Pages.off("show.bs.tab",r).parent(".active").nextAll(":not(.ewHidden):not(.ewDisabled)").first().find("[data-toggle=tab]").click();return false});if(this.HideTabs)this.$Form.find(".ewMultiPage > .tabbable > .nav-tabs, .ewMultiPage > .nav-tabs-custom > .nav-tabs").hide()}else if(this.isCollapse){if(this.ShowPagerTop)$collapses.closest(".panel-group").before(e);if(this.ShowPagerBottom)$collapses.closest(".panel-group").after(e);this.$Form.find(".ewPrev").click(function(e){a.$Pages.closest(".panel-heading").next("in").parent().prevAll(":not(.ewHidden)").first().find("[data-toggle=collapse]").click();return false});this.$Form.find(".ewNext").click(function(e){a.$Pages.closest(".panel-heading").next("in").parent().nextAll(":not(.ewHidden)").first().find("[data-toggle=collapse]").click();return false})}this.PageShow()};this.PageShow=function(){if(this.isTab){if(this.LockTabs)this.$Pages.on("show.bs.tab",r);this.$Pages.parent("li").each(function(){var e=t(this);if(a.HideInactivePages)e.toggleClass("hidden",!e.hasClass("active"));if(a.LockTabs)e.toggleClass("disabled",!e.hasClass("active"))})}else if(this.isCollapse){this.$Pages.closest(".panel").each(function(){var e=t(this);if(a.HideInactivePages)e.toggleClass("hidden",!e.find(".in")[0])})}var e=this.LastPageSubmit&&this.PageIndex!=this.MaxPageIndex;var i=this.$Form.find("#btnAction");i.prop("disabled",e).toggle(!this.HideDisabledButton||!e);e=this.PageIndex<=this.MinPageIndex;this.$Form.find(".ewPrev").toggleClass("disabled",e).toggle(!this.HideDisabledButton||!e);e=this.PageIndex>=this.MaxPageIndex;this.$Form.find(".ewNext").toggleClass("disabled",e).toggle(!this.HideDisabledButton||!e)};this.GotoPage=this.GotoPageByIndex=function(e){if(e<=0||e<this.MinPageIndex||e>this.MaxPageIndex)return;if(this.PageIndex!=e){var t=this.$Pages.eq(e-1);if(this.isTab){var a=t.parent();if(a.is(":not(.ewHidden):not(.ewDisabled)"))t.click();else a.nextAll(":not(.ewHidden):not(.ewDisabled)").first().find("[data-toggle=tab]").click()}else if(this.isCollapse){var a=t.closest(".panel");if(a.is(":not(.ewHidden)"))t.click();else a.nextAll(":not(.ewHidden)").first().find("[data-toggle=collapse]").click()}}};this.GotoPageByElement=function(e){this.GotoPage(parseInt(t(e).data("page"),10)||-1)};this.GotoPageByElementId=function(e){var t=this.$Form.find("[data-page]").filter("[id='"+e+"'],[name='"+e+"'],[data-field='"+e+"']");this.GotoPageByElement(t)};this.TogglePage=function(e,t){if(this.isTab){this.$Pages.eq(e-1).parent().toggleClass("hidden ewHidden",!t)}else if(this.isCollapse){this.$Pages.eq(e-1).closest(".panel").toggle("hidden ewHidden",!t)}};this.Render=function(){this.$Form=t("#"+e);this.PageIndexes=this.$Form.find("[data-page]").map(function(){return parseInt(t(this).data("page"),10)}).get();this.PageIndexes.sort(function(e,t){return e-t});this.MinPageIndex=this.PageIndexes[0];this.MaxPageIndex=this.PageIndexes[this.PageIndexes.length-1];var r=this.$Form.find("[data-toggle=tab]");if(r[0]){this.$Pages=r;this.isTab=true;r.on("shown.bs.tab",function(e){a.PageIndex=r.index(e.target)+1;a.PageShow();t(t(this).attr("href")).find(".ewGoogleMap").each(function(){var e=ewGoogleMaps[this.id];if(e&&e["map"]){google.maps.event.trigger(e["map"],"resize");e["map"].setCenter(e["latlng"])}})});this.PageIndex=r.index(r.parent(".active"))+1}else{var i=this.$Form.find("[data-toggle=collapse]");if(i[0]){this.$Pages=i;this.isCollapse=true;var n=i.closest(".panel-heading").next();n.on("shown.bs.collapse",function(e){a.PageIndex=n.index(e.target)+1;a.PageShow();t(this).find(".ewGoogleMap").each(function(){var e=ewGoogleMaps[this.id];if(e&&e["map"]){google.maps.event.trigger(e["map"],"resize");e["map"].setCenter(e["latlng"])}})});this.PageIndex=n.index(n.hasClass("in"))+1}}t(function(){a.Init()})}}function ew_GetElements(e,t){var a=jQuery,r="[name='"+e+"']";var i=e.split(" ");if(i.length==2)r="[data-table='"+i[0]+"'][data-field='"+ew_GetId(i[1])+"']:not([name^=o]):not([name^='x$'])";var t=!a.isString(t)?t:/^#/.test(t)?t:"#"+t;r="input"+r+",select"+r+",textarea"+r+",button"+r;var n=t?a(t).find(r):a(r);if(n.length==1&&n.is(":not([type=checkbox]):not([type=radio])"))return n[0];return n.get()}function ew_GetElement(e,t){var a=jQuery,t=a.isString(t)?"#"+t:t,r="#"+e.replace(/([\$\[\]])/g,"\\$1")+",[name='"+e+"']";return t?a(t).find(r)[0]:a(r).first()[0]}function ew_GetAncestorBy(e,t){while(e=e.parentNode){if(e&&e.nodeType==1&&(!t||t(e)))return e}return null}function ew_IsHidden(e){var t=jQuery;return t(e).css("display")=="none"&&!t(e).closest(".dropdown-menu")[0]&&!ew_IsModalLookup(e)&&!ew_IsAutoSuggest(e)&&!ew_IsHiddenTextArea(e)||ew_GetAncestorBy(e,function(e){var a=t(e);return a.css("display")=="none"&&!a.hasClass("tab-pane")&&!a.hasClass("collapse")})!=null}function ew_SameText(e,t){return String(e).toLowerCase()==String(t).toLowerCase()}function ew_SameStr(e,t){return String(e)==String(t)}function ew_InArray(e,t){return t.indexOf(e)}function ew_GetOptValues(e,t){var a=jQuery,r;if(a.isString(e)){var i=e.split(" ");if(i.length==2){r=ew_GetElements(e)}else{r=ew_GetElements(e,t)}}else{r=e}if(r.options){return a(r).find("option:selected[value!='']").map(function(){return this.value}).get()}else if(a.isNumber(r.length)){return a(r).filter(":checked[value!='{value}']").map(function(){return this.value}).get()}else{var n=a(r).data();if(n.lookup&&n.multiple)return r.value.split(",");else return[r.value]}}function ew_GetOptTexts(e,t){var a=jQuery,r;if(a.isString(e)){var i=e.split(" ");if(i.length==2){r=ew_GetElements(e)}else{r=ew_GetElements(e,t)}}else{r=e}if(r.options){return a(r).find("option:selected[value!='']").map(function(){return this.text}).get()}else if(a.isNumber(r.length)){return a(r).filter(":checked[value!='{value}']").map(function(){return a(this).parent().text()}).get()}else if(ew_IsAutoSuggest(r)){return[ew_GetAutoSuggest(r).input.value]}else if(ew_IsModalLookup(r)){var n=a(r),o=n.parent().find(".ewLookupText").val();return n.data("multiple")?o.split(", "):[o]}else{return[r.value]}}function ew_ClearOpt(e){var t=jQuery;if(e.options){var a=e.type=="select-multiple"||t(e).data("pleaseselect")===false||e.length>0&&e.options[0].value!=""?0:1;for(var r=e.length-1;r>=a;r--)e.options[r]=null}else if(e.length){var i=ew_GetId(e),n=t(e).parent().parent().find("#dsl_"+i);n.data("options",[]).find("div").first().empty()}else if(ew_IsAutoSuggest(e)){var o=ew_GetAutoSuggest(e);o._options=[];o.input.value="";e.value=""}else if(ew_IsModalLookup(e)){t(e).data("options",[])}}function ew_GetId(e,t){var a=jQuery,r=a.isString(e)?e:a(e).attr("name")||a(e).attr("id");return t!==false?r.replace(/\[\]$/,""):r}function ew_ValueSeparator(e,t){var a=jQuery,r=a(t).data("value-separator");return a.isArray(r)?r[e-1]:r||", "}function ew_DisplayValue(e,t){var a=jQuery,r=e[1];for(var i=2;i<=4;i++){if(e[i]&&e[i]!=""){var n=ew_ValueSeparator(i-1,t);if(a.isUndefined(n))break;if(r!="")r+=n;r+=e[i]}}return r}function ew_NewOpt(e,t,a){var r=jQuery,i=ewForms[a.id],n=ew_GetId(e),o=ew_GetId(e,false),s,l=t[0],d={lf:t[0],df1:t[1],df2:t[2],df3:t[3],df4:t[4]};if(i.Lists(o).Template&&!ew_IsAutoSuggest(e)){s=i.Lists(o).Template.render(d)}else{s=ew_DisplayValue(t,e)||l}var u={data:d,name:n,form:a.$Element,value:l,text:s};if(e.options){r.extend(u,{option:r("<option/>").val(u.value).html(u.text)});r(document).trigger("newoption",[u]);r(e).append(u.option)}else if(e.length){var f=r(ew_GetElement("dsl_"+n,a)),c=f.data("options");if(f[0]&&c)c[c.length]={val:u.value,lbl:u.text}}else if(ew_IsAutoSuggest(e)){var p=ew_GetAutoSuggest(e);p._options[p._options.length]={val:u.value,lbl:u.text}}else if(ew_IsModalLookup(e)){var h=r(e),c=h.data("options")||[];c[c.length]={val:u.value,lbl:u.text};h.data("options",c)}return u.text}function ew_RenderOpt(e){var t=jQuery,a=ew_GetId(e),r=ew_GetForm(e),i=t(e).parent().parent().find("#dsl_"+a);if(!i[0]||!i.data("options"))return;var n=i.parent().find("#tp_"+a);if(!n[0])return;var o=!EW_IS_MOBILE?parseInt(i.data("repeatcolumn"),10)||5:1;var s=n.contents(),l=i.data("options"),d=s.attr("type");var u=i.prevAll(".dropdown-toggle"),f=i.prevAll(".ewDropdownListClear");if(l&&l.length){if(o>1||d=="checkbox"||!u[0]){var c=t('<table class="ewItemTable"></table>');if(d=="checkbox")c.click(function(e){e.stopPropagation()});for(var p=0,h=l.length;p<h;p++){if(p%o==0)$tr=t("<tr></tr>");var g=s.clone(true).val(l[p].val).click(function(e){if(u[0]){var a=c.find("input[name='"+this.name+"']:checked");var r=a.map(function(){return t(this).parent().text()}).get();var i=r.length>(t(this).data("maxcount")||3)?ewLanguage.Phrase("CountSelected").replace("%s",r.length):r.join(", ");u.html(r.length?i:ewLanguage.Phrase("PleaseSelect"));f.toggle(r.length>0)}});var _=t('<label class="'+d+'-inline"></label>').append(g.attr("id",g.attr("id")+"_"+p),l[p].lbl);var w={name:a,form:r,value:l[p].val,text:l[p].lbl,option:_};t(document).trigger("newoption",[w]);t("<td></td>").append(w.option).appendTo($tr);if(p%o==o-1){c.append($tr)}else if(p==h-1){for(var v=p%o+1;v<o;v++)$tr.append("<td></td>");c.append($tr)}}i.find("div").first().append(c)}else{var m=t('<div class="list-group"></div>');for(var p=0,h=l.length;p<h;p++){var g=s.clone(true).val(l[p].val).click(function(e){var a=t(this).closest(".list-group-item");if(a.hasClass("active"))this.checked=false;a.siblings(".list-group-item").removeClass("active");a.toggleClass("active",this.checked);u.html(this.checked?a.text():ewLanguage.Phrase("PleaseSelect"));f.toggle(this.checked)});var _=t('<label class="'+d+'-inline"></label>').append(g.attr("id",g.attr("id")+"_"+p),l[p].lbl);var E=t('<a class="list-group-item" href="#"></a>').append(_);var w={name:a,form:r,value:l[p].val,text:l[p].lbl,option:E};t(document).trigger("newoption",[w]);m.append(w.option)}i.find("div").first().append(m)}var b=t.trim(u.html());f.toggle(!!b&&b!=ewLanguage.Phrase("PleaseSelect")).off().click(function(e){i.find("[data-field][type=radio], [data-field][type=checkbox]").prop("checked",false).first().triggerHandler("click");i.find(".list-group-item.active").removeClass("active");u.html(ewLanguage.Phrase("PleaseSelect"));f.hide()})}if(!i.hasClass("dropdown-menu"))i.show();i.data("options",[])}function ew_SelectOpt(e,t){if(!e||!t)return;var a=jQuery,r=a(e);if(t[0]){if(e.options){a(e).val(t);if(e.type=="select-one"&&e.selectedIndex==-1)e.selectedIndex=0}else if(e.length){if(e.length==1&&e[0].type=="checkbox"&&e[0].value!="{value}"){e[0].checked=ew_ConvertToBool(e[0].value)===ew_ConvertToBool(t[0])}else{r.val(t).closest(".ewDropdownList").find(".ewDropdownListClear").show()}}else if(ew_IsAutoSuggest(e)&&t.length==1){var i=ew_GetAutoSuggest(e),n=i._options||[];for(var o=0,s=n.length;o<s;o++){if(n[o].val==t[0]){e.value=n[o].val;i.input.value=n[o].lbl;break}}}else if(ew_IsModalLookup(e)){var r=a(e),l="",d="",n=r.data("options")||[];for(var u=0,f=t.length;u<f;u++){for(var o=0,s=n.length;o<s;o++){if(t[u]==n[o].val){l+=(l!==""?EW_LOOKUP_FILTER_VALUE_SEPARATOR:"")+n[o].val;d+=(d!==""?", ":"")+n[o].lbl;break}}}r.val(l);r.parent().find(".ewLookupText").html(d!==""?d:ewLanguage.Phrase("PleaseSelect"))}else if(e.type){e.value=t.join(",")}}function c(e){if(!a(e).data("autoselect"))return false;var t=ew_GetForm(e);if(t){if(/s(ea)?rch$/.test(t.id))return false;var r=ewForms[t.id].Lists(e.id);if(r&&r.ParentFields.length==0)return false;return true}return false}if(e.options){if(e.type=="select-one"&&e.options.length==2&&!e.options[1].selected&&c(e)){e.options[1].selected=true}else if(e.type=="select-multiple"&&e.options.length==1&&!e.options[0].selected&&c(e)){e.options[0].selected=true}}else if(e.length){if(e.length==2&&c(e[1]))e[1].checked=true;if(e[0].type=="radio")r.filter(":checked").closest(".list-group-item").addClass("active");var p=r.closest(".dropdown-menu");var h=p.prevAll(".dropdown-toggle");if(h[0]){var g=p.find("input[name='"+e[0].name+"']:checked");var _=g.map(function(){return a(this).parent().text()}).get();var d=_.length>(r.data("maxcount")||3)?ewLanguage.Phrase("CountSelected").replace("%s",_.length):_.join(", ");h.html(_.length?d:ewLanguage.Phrase("PleaseSelect"))}}else if(ew_IsAutoSuggest(e)){var i=ew_GetAutoSuggest(e),n=i._options||[];if(n.length==1&&c(e)){e.value=n[0].val;i.input.value=n[0].lbl}}}function ew_AutoSuggest(e){var t,a,r=this,i=jQuery,n=e.id,o=e.form,s=e.forceSelect;var l=n.replace(/^[xy](\d*|\$rowindex\$)_/,"x_");var d=RegExp.$1;var u={typeahead:{}};if(d=="$rowindex$")return u;var f=o.GetElement();var c=o.GetElement("sv_"+n);if(!c)return u;var p=o.GetElement("sc_"+n);var h=o.Lists[l].ParentFields.slice();for(var g=0,_=h.length;g<_;g++){var w=h[g].split(" ");if(w.length==1)h[g]=h[g].replace(/^x_/,"x"+d+"_")}this.data=e.data;this.minWidth=e.minWidth;this.maxHeight=e.maxHeight;this.highlight=e.highlight;this.hint=e.hint;this.minLength=e.minLength;this.limit=e.limit;this.templates=i.extend({},e.templates);this.trigger=e.trigger;this.delay=e.delay;this.display=e.display||"value";this.input=c;this.element=o.GetElement(n);this.$input=t=i(this.input);this.$element=a=i(this.element);this._options=[];this._recordCount=0;if(t.val()&&a.val())this._options.push({val:a.val(),lbl:t.val()});this.formatResult=function(e){return ew_DisplayValue(e,this.element)||e[0]};this.setValue=function(e){e=e||t.val();var r=t.data("results")?i.map(t.data("results"),function(t,a){if(t["value"]==e)return a}):[];if(r.length==0){if(this._options&&this._options.length&&this._options[this._options.length-1].lbl==e)return;if(s&&e){t.typeahead("val","").attr("placeholder",ewLanguage.Phrase("ValueNotExist")).parent().append('<span class="glyphicon glyphicon-warning-sign form-control-feedback"></span>').addClass("has-error has-feedback");a.val("").change();return}}else{if(!/s(ea)?rch$/.test(f.id)||s){var n=r[0];if(n>-1)e=t.data("results")[n][0]}}if(e!==a.val())a.val(e).change()};this.generateRequest=function(){var e=this.data;if(h.length>0){for(var t=0,a=h.length;t<a;t++){var r=ew_GetOptValues(h[t],f);e+="&v"+(t+1)+"="+encodeURIComponent(r.join(","))}}return"name="+this.element.name+"&"+e};this.prepare=function(e,t){var a={};a.data=this.generateRequest();a.type="POST";a.dataType="json";a.url=EW_LOOKUP_FILE_NAME+"?q="+encodeURIComponent(e);a.url+="&n="+this.limit;if(i.isNumber(t))a.url+="&start="+t;a.url+="&rnd="+ew_Random();return a};this.transform=function(e){var a;if(e&&e.Result=="OK"){r._recordCount=e.TotalRecordCount;a=e.Records}t.data("results",a||[]);var n=i.map(t.data("results"),function(e){var t=e["value"]=r.formatResult(e);return{lf:e[0],df1:e[1],df2:e[2],df3:e[3],df4:e[4],value:t}});return n};this.source=function(e,t,a){r._recordCount=0;var n=r.prepare(e);i.ajax(n).done(function(e){a(r.transform(e))})};this.count=function(){return r.typeahead.menu.$node.find(".tt-suggestion.tt-selectable").length};this.more=function(){i("body").css("cursor","wait");var e=r.typeahead,t=e.menu.query,a=e.menu.datasets[0];var n=r.count();var o=r.prepare(t,n);i.ajax(o).done(function(i){i=r.transform(i);a._append(t,i);e.menu.$node.find(".tt-dataset").scrollTop(a.$lastSuggestion.outerHeight()*n)}).always(function(){i("body").css("cursor","default")})};t.on("typeahead:select",function(e,t){r.setValue(t.value)}).blur(function(e){var a=t.data("tt-typeahead");if(a&&a.isOpen()&&!a.menu.empty()){var i=a.menu.getActiveSelectable();if(i){var n=i.index();var o=t.data("results")[n][1];t.typeahead("val",o)}}r.setValue()}).focus(function(e){t.attr("placeholder",t.data("placeholder")).closest(".has-error.has-feedback").removeClass("has-error has-feedback").find(".form-control-feedback").remove()});var v;if(o.Lists[l].Template){v=o.Lists[l].Template}else{v=r.templates["suggestion"]}if(v&&i.isString(v))v=i.templates(v);if(v)r.templates["suggestion"]=i.proxy(v.render,v);a.data("autosuggest",this);i(function(){var e={highlight:r.highlight,minLength:r.minLength,hint:r.hint,trigger:r.trigger,delay:r.delay};var s={name:o.ID+"-"+n,source:r.source,templates:r.templates,display:r.display,limit:r.limit,async:true};var l=[e,s];a.trigger("typeahead",[l]);r.limit=s.limit;t.typeahead.apply(t,l);t.on("typeahead:rendered",function(){var t=r.typeahead.menu.$node;var a=t.find(".tt-more").html(ewLanguage.Phrase("More"));if(arguments.length>1&&r._recordCount>r.count()){var n;a.one(e.trigger,function(t){if(n)n.cancel();i.later(e.delay,null,function(){r.more()});t.preventDefault();t.stopPropagation()})}else{a.hide()}});t.off("blur.tt");r.typeahead=t.data("tt-typeahead");var d=r.typeahead.menu.$node.css("z-index",9001);if(r.minWidth)d.css("min-width",r.minWidth);var u=d.find(".tt-dataset");var f=r.maxHeight||(parseInt(u.css("line-height"),10)+6)*(s.limit+1);u.css({"max-height":f,"overflow-y":"auto"})})}function ew_ExecScript(e,t){var a,r=0,i=/<script([^>]*)>([\s\S]*?)<\/script\s*>/gi;e=e.replace(/<head>[\s\S]*<\/head>/,"");while((a=i.exec(e))!=null){var n=RegExp.$2;if(/(\s+type\s*=\s*['"]*(text|application)\/(java|ecma)script['"]*)|^((?!\s+type\s*=).)*$/i.test(RegExp.$1)&&n)ew_AddScript(n,"scr_"+t+"_"+r++)}}function ew_StripScript(e){var t,a=/<script([^>]*)>([\s\S]*?)<\/script\s*>/gi;var r=e;while((t=a.exec(e))!=null){var i=RegExp.lastMatch;if(/(\s+type\s*=\s*['"]*(text|application)\/(java|ecma)script['"]*)|^((?!\s+type\s*=).)*$/i.test(RegExp.$1))r=r.replace(i,"")}return r}function ew_AddScript(e,t){var a=document.createElement("SCRIPT");if(t)a.id=t;a.type="text/javascript";a.text=e;return document.body.appendChild(a)}function ew_RemoveScript(e){if(e)jQuery("script[id^='scr_"+e+"_']").remove()}function ew_SaveOpt(e){var t=jQuery,a=t(e),r=a.closest("[id^=el]").find("#dsl_"+ew_GetId(e));if(!r[0])return[];var i=a.filter(":checked").map(function(){return this.value}).get();ew_ClearOpt(e);r.data("options",a.filter("[value!='{value}']").map(function(){var e=t(this).parent().contents().not(this);return{val:this.value,lbl:e}}).get());return i}function ew_GetOptArray(e){var t=jQuery;if(e.options){return t(e.options).map(function(){return{value:this.value,name:this.text}}).get()}else if(e.length){return t(e).filter("[value!='{value}']").map(function(){var e=t(this).parent().contents().not(this);return{value:this.value,name:e.text()}}).get()}return[]}function ew_AddOptSuccess(e){var t=jQuery,a=ewAddOptDialog,r=e;if(!a)return;if(t.isString(e)){try{r=t.parseJSON(e)}catch(e){}}if(r&&r.length>0){var i=r[0];var n=a.data("args").el;var o="x_",s=-1;if(n.match(/^(x(\d+)_)/)){o=RegExp.$1;s=parseInt(RegExp.$2,10)}var l=ewForms(a.data("args").lnk);a.modal("hide");var d=l.$Element[0];var u=ew_GetElements(n,d);if(u){var f=n.replace(new RegExp("^"+o),"x_");var c=l.Lists[f].LinkField.slice();var p=l.Lists[f].DisplayFields.slice();var h=l.Lists[f].FilterFields.slice();var g=l.Lists[f].ParentFields.slice();for(var _=0,w=g.length;_<w;_++){var v=g[_].split(" ");if(v.length==1)g[_]=g[_].replace(/^x_/,o)}var m=c!=""?i[c]:"";var E=[m];for(var _=0,w=p.length;_<w;_++)E[E.length]=p[_]in i?i[p[_]]:"";for(var _=0,w=h.length;_<w;_++)E[E.length]=h[_]in i?i[h[_]]:"";if(m&&p.length>0&&E[1]){var b=ew_GetId(n,false),S=b.replace(new RegExp("^"+o),"x_");if(l.Lists[S].Ajax===null){var v=l.Lists[S].Options;v[v.length]=E}var y=[];for(var _=0,w=g.length;_<w;_++)y[y.length]=ew_GetOptValues(g[_],d);var A={data:E,parents:y,valid:true,name:ew_GetId(u),form:d};t(document).trigger("addoption",[A]);if(A.valid){var v=ew_GetOptArray(u),T=[];if(!u.options&&u.length)T=ew_SaveOpt(u);var L=ew_NewOpt(u,E,d);if(u.options){u.options[u.options.length-1].selected=true;t(u).change().focus()}else if(u.length){ew_RenderOpt(u);u=ew_GetElements(b,d);if(T.length>0)ew_SelectOpt(u,T);if(u.length>0){var n=t(u).filter("[value!='{value}']").last()[0];if(n.type=="checkbox"||n.type=="radio")n.click();n.focus()}}else if(ew_IsAutoSuggest(u)){var x=ew_GetAutoSuggest(u);t(u).val(m).change();t(x.input).val(L).focus()}else if(ew_IsModalLookup(u)){$obj=t(u),$lu=t(ew_GetElement("lu_"+A.name,d));if($obj.data("multiple")){var O=t(u).val(),T=[];if(O!=="")T=O.split(",");if(!T.includes(m)){T.push(m);t(u).val(T.join()).change();var I=$lu.html();I+=(I!==""?", ":"")+L;$lu.html(I)}}else{$obj.val(m).change();$lu.html(L)}}var C=t(d),P=C.is("div")?"_"+C.attr("id"):"";var k=C.find("#key_count"+P).val();if(k>0){for(var _=1;_<=k;_++){if(_==s)continue;var D=ew_GetElements(f.replace(/^x/,"x"+_),d);var M=ew_GetOptArray(D),T=[];if(t.param(v)!=t.param(M))continue;if(!D.options&&D.length)T=ew_SaveOpt(D);ew_NewOpt(D,E,d);if(!D.options&&D.length){ew_RenderOpt(D);if(T.length>0)ew_SelectOpt(D,T)}}}}}}}else{var R,W=a.find("div.ewMessageDialog").html(""),N=t("<div></div>").html(e).find("div.ewMessageDialog");if(N[0]){R=N.html()}else{R=e;if(!R||t.trim(R)=="")R=ewLanguage.Phrase("InsertFailed");R='<p class="text-danger">'+R+"</p>"}W.html(R).show()}}function ew_AddOptDialogHide(){if($dlg=ewAddOptDialog){ew_RemoveScript($dlg.data("args").el);var e=$dlg.removeData("args").find(".modal-body form").data("form");if(e)e.DestroyEditor();$dlg.find(".modal-body").html("");$dlg.find(".modal-footer .btn-primary").unbind();$dlg.data("showing",false)}}function ew_AddOptDialogShow(e){var t=jQuery,a=ewAddOptDialog||t("#ewAddOptDialog").on("hidden.bs.modal",ew_AddOptDialogHide);if(a.data("showing"))return
;a.data("showing",true);if(!a[0]){ew_Alert("DIV #ewAddOptDialog not found.");return}var r=function(e){a.modal("hide");ew_Alert("Server Error "+e.status+": "+e.statusText)};var i=function(e){var a=ewAddOptDialog;var i=a.find(".modal-body form")[0];var n=ewForms[i.id];var o=e?e.target:null;if(o){n.EnableForm=function(){if(!EW_DISABLE_BUTTON_ON_SUBMIT)return;t(o).prop("disabled",false).removeClass("disabled")};n.DisableForm=function(){if(!EW_DISABLE_BUTTON_ON_SUBMIT)return;t(o).prop("disabled",true).addClass("disabled")}}if(n.CanSubmit())t.post(i.action,t(i).serialize(),ew_AddOptSuccess).fail(r).always(function(){n.EnableForm()});return false};a.modal("hide");a.data("args",e);var n=function(r){var n=ewForms(e.lnk);var o="x_";if(e.el.match(/^(x\d+_)/))o=RegExp.$1;var s=e.el.replace(o,"x_");var l=n.Lists[s].ParentFields.slice();var d=n.Lists[s].FilterFields.slice();var u=n.Form;var f=[],c=[];for(var p=0,h=l.length;p<h;p++){var g=l[p].split(" ");if(g.length==1)l[p]=l[p].replace(/^x_/,o)}for(var p=0,h=l.length;p<h;p++){f.push(ew_GetOptValues(l[p],u));c.push(ew_GetOptTexts(l[p],u))}a.find(".modal-title").html(t(e.lnk).text());a.find(".modal-body").html(ew_StripScript(r));var u=a.find(".modal-body form")[0];if(u){t(u).keypress(function(e){if(e.which==13)return i()});var _=function(e,a){return t.isArray(e)&&t.isArray(a)&&e[0]&&a[0]&&e.name==a.name&&e.form==a.form};for(var p=0,h=f.length;p<h;p++){var w=ew_GetElements(d[p],u);if(w&&(w.options||w.length)){var v=f[p];t(document).one("updatedone",function(e,t){var a=t.target;if(w==a||_(w,a))ew_SelectOpt(a,v)})}}}ewAddOptDialog=a.modal("show");a.find(".modal-footer .btn-primary").click(i).focus();ew_ExecScript(r,e.el);if(u){for(var p=0,h=f.length;p<h;p++){var w=ew_GetElements(d[p],u);if(w){if(ew_IsAutoSuggest(w)){w.value=f[p][0];var m=ew_GetAutoSuggest(w);m.input.value=c[p][0];m._options[m._options.length]={val:f[p][0],lbl:c[p][0]}}else if(ew_IsModalLookup(w)){w.value=f[p][0];ew_UpdateOpt.call(ewForms[u.id],w)}else if(w.options||w.length){}else{w.value=f[p][0]}}}}};t.get(e.url,n).fail(r)}function ew_ModalDialogHide(e){var t=jQuery,a=t(this),r=a.data("args");ew_RemoveScript("ModalDialog");var i=r&&r.reload;var n=a.removeData("args").find(".modal-body form").data("form");if(n)n.DestroyEditor();$body=a.find(".modal-body").html("");if($body.ewjtable&&$body.ewjtable("instance"))$body.ewjtable("destroy");a.find(".modal-footer .btn-primary").unbind();a.find(".modal-dialog").removeClass(function(e,t){var a=t.match(/table\-\w+/);return a?a[0]:""});a.data("showing",false);a.data("url",null);if(i)window.location.reload(true)}function ew_ModalDialogShow(e){var t=jQuery,a=e.f,r=t(a);t(e.lnk).tooltip("hide");if(a&&r){if(!r[0])return;if(!ew_KeySelected(r[0])){ew_Prompt('<p class="text-danger">'+ewLanguage.Phrase("NoRecordSelected")+"</p>");return}}var i=ewModalDialog||t("#ewModalDialog").on("hidden.bs.modal",ew_ModalDialogHide);if(i.data("showing")&&i.data("url")==e.url)return;i.data("showing",true);i.data("url",e.url);e.reload=false;var n=function(){var e=i.data("args");var a=t(e.lnk);return e.caption||a.data("caption")||a.data("original-title")||""};var o=function(){var e=i.data("args");if(t.isNull(e.btn))return"";else if(e.btn&&e.btn!="")return ewLanguage.Phrase(e.btn);else return n()};var s=function(e){i.modal("hide");if(e.status)ew_Alert("Server Error "+e.status+": "+e.statusText)};var l=function(e){t("body").css("cursor","default")};var d=function(e){if(t.isString(e)){try{e=t.parseJSON(e)}catch(e){}}if(t.isArray(e)&&e.length>0)e=e[0];return e};var u=function(e){var a=t("<a>",{href:e})[0];return window.location.pathname.endsWith(a.pathname)};var f=function(e){var a=d(e);if(t.isObject(a)){var r=a.url;if(a.modal&&!u(r)){var n=i.data("args");n.reload=true;if(a.caption)n.caption=a.caption;n.btn=a.view?null:"";i.data("args",n);r+=(r.split("?").length>1?"&":"?")+"modal=1&rnd="+ew_Random();t("body").css("cursor","wait");t.ajax(r).done(p).fail(s).always(l)}else{i.modal("hide");window.location=r}}else{var f=ew_StripScript(e).match(/<body[\s\S]*>[\s\S]*<\/body>/i);var h=i.find(".modal-body").html(t(f[0]).not("div[id^=ew].modal, #ewTooltip"));var g="";var _=h.find("#a_confirm");var w=h.find("#a_conflict");if(w&&w.val()=="1"){g+='<button type="button" id="btnOverwrite" class="btn btn-primary ewButton">'+ewLanguage.Phrase("OverwriteBtn")+"</button>";g+='<button type="button" id="btnReload" class="btn btn-default ewButton">'+ewLanguage.Phrase("ReloadBtn")+"</button>";g+='<button type="button" class="btn btn-default ewButton" data-dismiss="modal">'+ewLanguage.Phrase("CancelBtn")+"</button>";i.find(".modal-footer").html(g);i.find(".modal-footer #btnOverwrite").on("click",{action:"overwrite"},c);i.find(".modal-footer #btnReload").on("click",{action:"I"},c)}else if(_&&_.val()=="F"){g+='<button type="button" class="btn btn-primary ewButton">'+ewLanguage.Phrase("ConfirmBtn")+"</button>";g+='<button type="button" class="btn btn-default ewButton">'+ewLanguage.Phrase("CancelBtn")+"</button>";i.find(".modal-footer").html(g);i.find(".modal-footer .btn-primary").click(c).focus();i.find(".modal-footer .btn-default").on("click",{action:"X"},c)}else{var v=o();if(v)g+='<button type="button" class="btn btn-primary ewButton">'+v+"</button>";g+='<button type="button" class="btn btn-default ewButton" data-dismiss="modal">'+ewLanguage.Phrase("CancelBtn")+"</button>";i.find(".modal-footer").html(g);i.find(".modal-footer .btn-primary").click(c).focus()}ew_ExecScript(e,"ModalDialog");i.trigger("load.ew")}};var c=function(e){var a=i.find(".modal-body form")[0];var r=ewForms[a.id];var n=e&&e.data?e.data.action:null;var o=e?e.target:null;if(o){r.EnableForm=function(){if(!EW_DISABLE_BUTTON_ON_SUBMIT)return;t(o).prop("disabled",false).removeClass("disabled")};r.DisableForm=function(){if(!EW_DISABLE_BUTTON_ON_SUBMIT)return;t(o).prop("disabled",true).addClass("disabled")}}var d=a.a_add||a.a_edit||a.a_update;if(n&&d)d.value=n;if(n=="X"){t.post(a.action,t(a).serialize(),p).fail(s).always(l)}else if(r.CanSubmit()){t.post(a.action,t(a).serialize(),f).fail(s)}return false};i.modal("hide");i.data("args",e);var p=function(e){var a=d(e);if(t.isObject(a)){if(a.error)ew_Alert(a.error)}else{var r=i.data("args");var s=t(e),l=t(r.lnk);i.find(".modal-title").html(n());var u="";var f=o();if(f)u+='<button type="button" class="btn btn-primary ewButton">'+f+"</button>";if(u!="")u+='<button type="button" class="btn btn-default ewButton" data-dismiss="modal">'+ewLanguage.Phrase("CancelBtn")+"</button>";else u='<button type="button" class="btn btn-default ewButton" data-dismiss="modal">'+ewLanguage.Phrase("CloseBtn")+"</button>";i.find(".modal-footer").html(u);var p=ew_StripScript(e).match(/<body[\s\S]*>[\s\S]*<\/body>/i);i.find(".modal-body").html(t(p[0]).not("div[id^=ew].modal, #ewTooltip"));i.find(".modal-body form").keypress(function(e){if(e.which==13&&e.target.nodeName!="TEXTAREA")return c()});ewModalDialog=i.modal("show");i.find(".modal-dialog").addClass("table-"+l.data("table"));i.find(".modal-footer .btn-primary").addClass("ewSubmit").click(c).focus();ew_ExecScript(e,"ModalDialog");i.trigger("load.ew")}};t("body").css("cursor","wait");var h=e.url;if(a&&r){t("<input>").attr({type:"hidden",name:"modal",value:"1"}).appendTo(r);t.post(h,r.serialize(),p).fail(s).always(l)}else{h+=(h.split("?").length>1?"&":"?")+"modal=1&rnd="+ew_Random();t.get(h,p).fail(s).always(l)}}function ew_ModalLookupShow(e){var t=jQuery,a=e.el,r=ew_GetForm(e.lnk);if(!r||!a)return;var i=ewModalLookupDialog||t("#ewModalLookupDialog").on("hidden.bs.modal",ew_ModalDialogHide);if(i.data("showing"))return;i.data("showing",true);if(!i[0]){ew_Alert("DIV #ewModalLookupDialog not found.");return}var n=ew_GetId(a,true),o=t(r),s=o.find("[id='"+a+"']"),l=i.find(".modal-body");s.parent().find(".ewLookupText").focus();var d=function(e){if(e.Result=="OK"&&t.isArray(e.Records)){t.each(e.Records,function(t,a){var r={lf:a[0],df1:a[1],df2:a[2],df3:a[3],df4:a[4]};if(S.Template){r["df"]=S.Template.render(r)}else{r["df"]=ew_DisplayValue(a,s)}e.Records[t]=r})}};var u=function(e,t){if(!ew_IsAutoSuggest(s))return;var a=ew_GetAutoSuggest(s[0]);a._options[a._options.length]={val:e,lbl:t};a.input.value=t};var f=function(a){var r=[],i="",n="",o=!e.m&&e.srch;l.ewjtable("selectedRows").each(function(){var e=t(this).data("record");var a=t.map(e,function(e){return e});r.push(e.lf);i+=(i!==""?", ":"")+e.df;n+=(n!==""?", ":"")+ew_DisplayValue(a,s)});if(a.sort().join()===r.sort().join()){t(e.lnk).prev(".ewLookupList").find(".ewLookupText").html(i!=""?i:ewLanguage.Phrase("PleaseSelect"));u(r.join(),n);s.val(o?i:r.join()).change()}else{var f=T+"&"+t.param({keys:a});t.ajax(EW_MODAL_LOOKUP_FILE_NAME,{type:"POST",dataType:"json",data:f}).done(d).then(function(a){if(a.Result=="OK"&&t.isArray(a.Records)){var r=[],i="",n="",l=a.Records;for(var d=0,f=l.length;d<f;d++){var c=l[d];var p=t.map(c,function(e){return e});r.push(c.lf);i+=(i!==""?", ":"")+c.df;n+=(n!==""?", ":"")+ew_DisplayValue(p,s)}t(e.lnk).prev(".ewLookupList").find(".ewLookupText").html(i!=""?i:ewLanguage.Phrase("PleaseSelect"));u(r.join(),n);s.val(o?i:r.join()).change()}})}};var c=function(){f(A);i.modal("hide");return false};i.modal("hide");i.data("args",e);var p,h;var g=function(a){if(a.Result=="OK"){i.find(".modal-title").html(t(e.lnk).attr("title")||t(e.lnk).data("original-title"));i.find(".modal-footer").html('<button type="button" id="btnSelect" class="btn btn-primary ewButton">'+ewLanguage.Phrase("SelectBtn")+"</button>"+'<button type="button" class="btn btn-default ewButton" data-dismiss="modal">'+ewLanguage.Phrase("CancelBtn")+"</button>");h=t('<input type="text" name="sv" class="form-control" placeholder="'+ewLanguage.Phrase("Search")+'">').prependTo(l).on("keyup",function(e){if(p)p.cancel();p=t.later(EW_LOOKUP_DELAY,null,function(){l.ewjtable("load",{sv:h.val()})})});i.find(".modal-footer #btnSelect").click(c);ewModalLookupDialog=i.modal("show");i.find("[name=sv]").focus()}else{ew_Alert(a.Message)}};var _=ew_GetId(a,false);var w="",v="",m=_.match(/^([xy])(\d*)_/);if(m){w=m[1];v=m[2]}var E=_.replace(/^([xy])(\d*)_/,"x_");var b=[];var S=ewForms[r.id].Lists(E);var y=s.val();var A=y!==""?y.split(","):[];var T=S.Data;T+="&lt="+encodeURIComponent(S.LinkTable);T+="&lf="+encodeURIComponent(S.LinkField.substring(2));for(var L=0,x=S.DisplayFields.length;L<x;L++)T+="&ldf"+(L+1)+"="+encodeURIComponent(S.DisplayFields[L].substring(2));var O=S.ParentFields.slice();if(v!=""){for(var L=0,I=O.length;L<I;L++){var C=O[L].split(" ");if(C.length==1)O[L]=O[L].replace(/^x_/,"x"+v+"_")}}if(O.length>0){for(var L=0,I=O.length;L<I;L++)b[b.length]=ew_GetOptValues(O[L],r)}for(var L=0,x=b.length;L<x;L++)T+="&v"+(L+1)+"="+encodeURIComponent(b[L].join(EW_LOOKUP_FILTER_VALUE_SEPARATOR));t("body").css("cursor","wait");l.ewjtable({paging:true,pageSize:e.n,pageSizes:[],pageSizeChangeArea:false,paging:true,pageList:"minimal",selecting:true,selectingCheckboxes:true,multiselect:!!e.m,actions:{listAction:function(e,a){var r=T+"&start="+a.start+"&recperpage="+a.recperpage;if(t.isObject(e))r+="&"+t.param(e);return t.Deferred(function(e){t.ajax(EW_MODAL_LOOKUP_FILE_NAME,{type:"POST",dataType:"json",data:r,success:function(t){e.resolve(t)},error:function(){e.reject()}})}).done(d).always(function(){t("body").css("cursor","default")})}},messages:{serverCommunicationError:ewLanguage.Phrase("ServerCommunicationError"),loadingMessage:ewLanguage.Phrase("Loading"),noDataAvailable:ewLanguage.Phrase("NoRecord"),close:ewLanguage.Phrase("CloseBtn"),pagingInfo:ewLanguage.Phrase("Record")+" {0}-{1} "+ewLanguage.Phrase("Of")+" {2}",pageSizeChangeLabel:ewLanguage.Phrase("RecordsPerPage"),gotoPageLabel:ewLanguage.Phrase("Page")},fields:{lf:{key:true,list:false},df:{}},recordsLoaded:function(e,a){var r=t(e.target).find(".ewjtable-data-row").filter(function(){return A.includes(String(t(this).data("record-key")))});t(e.target).ewjtable("selectRows",r)},selectionChanged:function(a,r){var i=r.rows;if(i){if(!e.m)A=[];i.each(function(){var e=t(this);var a=String(e.data("record-key"));var r=A.indexOf(a);var i=e.hasClass("ewjtable-row-selected");if(i&&r==-1)A.push(a);else if(!i&&r>-1)A.splice(r,1)})}}}).ewjtable("load",null,g)}function ew_AutoFill(e){var t=jQuery,a=ewForms(e).$Element[0];if(!a)return;var r=ew_GetOptValues(e);var i=ew_GetId(e);var n=ew_GetElement("ln_"+i,a);if(!n||n.value=="")return;var o=n.value.split(",");var s=function(r){var n=r||"";var s=n?n[0]:[];for(var l=0;l<o.length;l++){var d=ew_GetElements(o[l],a);if(d){var u=t.isValue(s[l])?s[l]:"";var f={results:n,result:s,data:u,form:a,name:i,target:o[l],cancel:false,trigger:true};t(e).trigger("autofill",[f]);if(f.cancel)continue;u=f.data;if(d.options||d.length&&d[0].type=="radio"){ew_SelectOpt(d,u.split(","))}else if(d.length&&d[0].type=="checkbox"){ew_SelectOpt(d,u.split(","))}else if(ew_IsAutoSuggest(d)){d.value=u;ew_GetAutoSuggest(d).input.value=u;ew_UpdateOpt.call(ewForms[a.id],d)}else if(ew_IsModalLookup(d)){d.value=u;ew_UpdateOpt.call(ewForms[a.id],d)}else if(ew_IsHiddenTextArea(d)){d.value=u;t(d).data("editor").set()}else{d.value=u}if(f.trigger)t(d).change()}}};if(r.length>0&&r[0]!=""){var l={ajax:"autofill",form:a.id,name:i,target:n.value,q:r[0],token:EW_TOKEN};t.post(ew_CurrentPage(),l,s,"json")}else{s()}}function ew_Tooltip(e,t){var a=jQuery,r=a(t),i=a("#"+r.data("tooltip-id")),n=r.data("trigger")||"hover",o=r.data("placement")||(EW_CSS_FLIP?"left":"right");if(!i[0]||a.trim(i.text())==""&&!i.find("img[src!='']")[0])return;if(!r.data("bs.popover")){r.popover({html:true,placement:o,trigger:n,delay:100,container:a("#ewTooltip")[0],content:i.contents()}).on("show.bs.popover",function(e){var t=r.data("bs.popover").tip();if(wd=r.data("tooltip-width"))t.css("max-width",parseInt(wd,10)+"px")}).on("shown.bs.popover",function(e){if(o!="left"&&o!="right")return;var t=function(e){return e.offset().top};var i=a(e.target),n=i.width(),s=i.height(),l=a(document),d=a(document.body),u=r.data("bs.popover").tip(),f=u.width(),c=t(u);var p=l.scrollTop()+d.outerHeight()-u.outerHeight();c=Math.max(l.scrollTop(),Math.min(p,c));u.css("top",c+"px");var h=u.find(".arrow");c=t(i)-c+s/2-h.height();var g=(parseInt(u.css("border-top-left-radius"),10)||6)-parseInt(h.css("margin-top"),10);var _=u.height()-g-h.height();h.css("top",Math.max(g,Math.min(c,_))+"px")})}}function ew_EmailDialogShow(e){var t=jQuery,a=ewEmailDialog||t("#ewEmailDialog");if(!a[0]){ew_Alert("DIV #ewEmailDialog not found.");return}if(e.sel&&!ew_KeySelected(e.f)){ew_Alert(ewLanguage.Phrase("NoRecordSelected"));return}var r=a.find(".modal-body form");var i=r.data("form");if(!i){i=new ew_Form(r.attr("id"));i.Validate=function(){var e,t=this.GetForm();e=t.elements["sender"];if(e&&!ew_HasValue(e))return this.OnError(e,ewLanguage.Phrase("EnterSenderEmail"));if(e&&!ew_CheckEmailList(e.value,1))return this.OnError(e,ewLanguage.Phrase("EnterProperSenderEmail"));e=t.elements["recipient"];if(e&&!ew_HasValue(e))return this.OnError(e,ewLanguage.Phrase("EnterRecipientEmail"));if(e&&!ew_CheckEmailList(e.value,EW_MAX_EMAIL_RECIPIENT))return this.OnError(e,ewLanguage.Phrase("EnterProperRecipientEmail"));e=t.elements["cc"];if(e&&!ew_CheckEmailList(e.value,EW_MAX_EMAIL_RECIPIENT))return this.OnError(e,ewLanguage.Phrase("EnterProperCcEmail"));e=t.elements["bcc"];if(e&&!ew_CheckEmailList(e.value,EW_MAX_EMAIL_RECIPIENT))return this.OnError(e,ewLanguage.Phrase("EnterProperBccEmail"));e=t.elements["subject"];if(e&&!ew_HasValue(e))return this.OnError(e,ewLanguage.Phrase("EnterSubject"));return true};i.Submit=function(){if(!this.Validate())return false;var i=r.serialize(),n="";if(e.f&&e.sel)n=t(e.f).find("input[type=checkbox][name='key_m[]']:checked").serialize();if(e.key)i+="&"+t.param(e.key);var o=this.GetForm();if(e.url){a.modal("hide");ew_Export(e.f,e.url,"email",true,e.sel,o)}else{t.post(e.f.action,i+"&"+n,function(e){ew_ShowMessage(e)})}return true};r.data("form",i)}a.modal("hide").find(".modal-title").html(e.hdr);a.find(".modal-footer .btn-primary").unbind().click(function(e){e.preventDefault();if(i.Submit())a.modal("hide")});ewEmailDialog=a.modal("show")}function ew_Ajax(e,t,a){if(!e)return undefined;var r=jQuery,i=r.extend({s:e},r.isObject(t)?t:{q:t});var n=function(e){if(r.isArray(e)&&e.length==1){e=e[0];if(r.isArray(e)&&e.length==1)return e[0];else return e}return e};if(r.isFunction(a)){r.post(EW_LOOKUP_FILE_NAME,i,function(e){a(n(e))},"json")}else{var o=r.ajax({url:EW_LOOKUP_FILE_NAME,async:false,type:"POST",data:i}).responseText;var s=r.parseJSON(o);return n(s)}}function ew_CurrentPage(){return location.href.split("?")[0]}function ew_ToggleSrchOpr(e,t){var a=this.form.elements[e];if(!a)return;a.value=a.value!=t?t:"="}function ew_CheckUSDate(e){return ew_CheckDateEx(e,"us",EW_DATE_SEPARATOR)}function ew_CheckShortUSDate(e){return ew_CheckDateEx(e,"usshort",EW_DATE_SEPARATOR)}function ew_CheckDate(e){return ew_CheckDateEx(e,"std",EW_DATE_SEPARATOR)}function ew_CheckShortDate(e){return ew_CheckDateEx(e,"stdshort",EW_DATE_SEPARATOR)}function ew_CheckEuroDate(e){return ew_CheckDateEx(e,"euro",EW_DATE_SEPARATOR)}function ew_CheckShortEuroDate(e){return ew_CheckDateEx(e,"euroshort",EW_DATE_SEPARATOR)}function ew_CheckDateDef(e){if(EW_DATE_FORMAT.match(/^yyyy/))return ew_CheckDate(e);else if(EW_DATE_FORMAT.match(/^yy/))return ew_CheckShortDate(e);else if(EW_DATE_FORMAT.match(/^m/)&&EW_DATE_FORMAT.match(/yyyy$/))return ew_CheckUSDate(e);else if(EW_DATE_FORMAT.match(/^m/)&&EW_DATE_FORMAT.match(/yy$/))return ew_CheckShortUSDate(e);else if(EW_DATE_FORMAT.match(/^d/)&&EW_DATE_FORMAT.match(/yyyy$/))return ew_CheckEuroDate(e);else if(EW_DATE_FORMAT.match(/^d/)&&EW_DATE_FORMAT.match(/yy$/))return ew_CheckShortEuroDate(e);return false}function ew_CheckDateEx(e,t,a){if(!e||e.length=="")return true;e=e.replace(/ +/g," ");e=e.replace(/^\s*|\s*$/g,"");var r=e.split(" ");if(r.length>0){var i,n,o,s;i=/^(\d{4})-([0][1-9]|[1][0-2])-([0][1-9]|[1|2]\d|[3][0|1])$/;if(ar=i.exec(r[0])){n=ar[1];o=ar[2];s=ar[3]}else{var l="\\"+a;switch(t){case"std":i=new RegExp("^(\\d{4})"+l+"([0]?[1-9]|[1][0-2])"+l+"([0]?[1-9]|[1|2]\\d|[3][0|1])$");break;case"stdshort":i=new RegExp("^(\\d{2})"+l+"([0]?[1-9]|[1][0-2])"+l+"([0]?[1-9]|[1|2]\\d|[3][0|1])$");break;case"us":i=new RegExp("^([0]?[1-9]|[1][0-2])"+l+"([0]?[1-9]|[1|2]\\d|[3][0|1])"+l+"(\\d{4})$");break;case"usshort":i=new RegExp("^([0]?[1-9]|[1][0-2])"+l+"([0]?[1-9]|[1|2]\\d|[3][0|1])"+l+"(\\d{2})$");break;case"euro":i=new RegExp("^([0]?[1-9]|[1|2]\\d|[3][0|1])"+l+"([0]?[1-9]|[1][0-2])"+l+"(\\d{4})$");break;case"euroshort":i=new RegExp("^([0]?[1-9]|[1|2]\\d|[3][0|1])"+l+"([0]?[1-9]|[1][0-2])"+l+"(\\d{2})$");break}if(!i.test(r[0]))return false;var d=r[0].split(a);switch(t){case"std":case"stdshort":n=ew_UnformatYear(d[0]);o=d[1];s=d[2];break;case"us":case"usshort":n=ew_UnformatYear(d[2]);o=d[0];s=d[1];break;case"euro":case"euroshort":n=ew_UnformatYear(d[2]);o=d[1];s=d[0];break}}if(!ew_CheckDay(n,o,s))return false}if(r.length>1&&!ew_CheckTime(r[1]))return false;return true}function ew_UnformatYear(e){if(e.length==2)return e>EW_UNFORMAT_YEAR?"19"+e:"20"+e;return e}function ew_CheckDay(e,t,a){e=parseInt(e,10);t=parseInt(t,10);a=parseInt(a,10);var r=[4,6,9,11].includes(t)?30:31;if(t==2)r=e%4>0||e%100==0&&e%400>0?28:29;return ew_CheckRange(a,1,r)}function ew_CheckInteger(e){if(!e||e.length==0)return true;if(e.indexOf(EW_DECIMAL_POINT)>-1)return false;return ew_CheckNumber(e)}function ew_CheckNumber(e){e=String(e);if(!e||e.length==0)return true;e=e.replace(/^\s*|\s*$/g,"");var t=new RegExp("^[+-]?(\\d{1,3}("+(EW_THOUSANDS_SEP?"\\"+EW_THOUSANDS_SEP+"?":"")+"\\d{3})*(\\"+EW_DECIMAL_POINT+"\\d+)?|\\"+EW_DECIMAL_POINT+"\\d+)$");return t.test(e)}function ew_StrToFloat(e){e=String(e);if(EW_THOUSANDS_SEP!=""){var t=new RegExp("\\"+EW_THOUSANDS_SEP,"g");e=e.replace(t,"")}if(EW_DECIMAL_POINT!="")e=e.replace(EW_DECIMAL_POINT,".");return parseFloat(e)}function ew_StrToDate(e){var t=/^(\d{4})-([0][1-9]|[1][0-2])-([0][1-9]|[1|2]\d|[3][0|1]) (?:(0\d|1\d|2[0-3]):([0-5]\d):([0-5]\d))?$/;var a=e.replace(t,"$1 $2 $3 $4 $5 $6").split(" ");return new Date(a[0],a[1]-1,a[2],a[3],a[4],a[5])}function ew_EscapeRegExChars(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function ew_CheckRange(e,t,a){if(!e||e.length==0)return true;var r=jQuery;if(r.isNumber(t)||r.isNumber(a)){if(ew_CheckNumber(e))e=ew_StrToFloat(e)}if(!r.isNull(t)&&e<t)return false;if(!r.isNull(a)&&e>a)return false;return true}function ew_CheckTime(e){if(!e||e.length==0)return true;e=e.replace(/^\s*|\s*$/g,"");var t=new RegExp("^(0\\d|1\\d|2[0-3])"+ew_EscapeRegExChars(EW_TIME_SEPARATOR)+"[0-5]\\d("+ew_EscapeRegExChars(EW_TIME_SEPARATOR)+"[0-5]\\d(\\.\\d+)?)?$","i");return t.test(e)}function ew_CheckPhone(e){if(!e||e.length==0)return true;e=e.replace(/^\s*|\s*$/g,"");var t=/^\(\d{3}\) ?\d{3}( |-)?\d{4}|^\d{3}( |-)?\d{3}( |-)?\d{4}$/;return t.test(e)}function ew_CheckZip(e){if(!e||e.length==0)return true;e=e.replace(/^\s*|\s*$/g,"");var t=/^\d{5}$|^\d{5}-\d{4}$/;return t.test(e)}function ew_CheckCreditCard(e){if(!e||e.length==0)return true;var t=e.replace(/\D/g,"");if(t.length==0)return false;var a=t.length%2==1?false:true;var r,i=0;for(var n=0,o=t.length;n<o;n++){r=parseInt(t.charAt(n),10);if(a){r*=2;i+=r%10;if(r/10>=1)i++;a=false}else{i+=r;a=true}}return i%10==0}function ew_CheckSSC(e){if(!e||e.length==0)return true;e=e.replace(/^\s*|\s*$/g,"");var t=/^(?!000)([0-6]\d{2}|7([0-6]\d|7[012]))([ -]?)(?!00)\d\d\3(?!0000)\d{4}$/;return t.test(e)}function ew_CheckEmailList(e,t){if(!e||e.length==0)return true;var a=e.replace(/,/g,";").split(";");for(var r=0,i=a.length;r<i;r++){if(t>0&&i>t)return false;if(!ew_CheckEmail(a[r]))return false}return true}function ew_CheckEmail(e){if(!e||e.length==0)return true;e=e.replace(/^\s*|\s*$/g,"");var t=/^[\w.%+-]+@[\w.-]+\.[A-Z]{2,18}$/i;return t.test(e)}function ew_CheckGUID(e){if(!e||e.length==0)return true;e=e.replace(/^\s*|\s*$/g,"");var t=/^\{\w{8}-\w{4}-\w{4}-\w{4}-\w{12}\}$/;var a=/^\w{8}-\w{4}-\w{4}-\w{4}-\w{12}$/;return t.test(e)||a.test(e)}function ew_CheckByRegEx(e,t){if(!e||e.length==0)return true;return!!e.match(t)}function ew_ShowMessage(e){if(window.location!=window.parent.location&&parent.ew_ShowMessage)return parent.ew_ShowMessage(e);var t=jQuery,a=e&&e.target?e.target:document,r=t(a).find("div.ewMessageDialog:hidden:first"),i=r.find(".alert").removeClass("alert");t.each(["success","info","warning","danger"],function(e,t){if(i.hasClass("alert-"+t))i.toggleClass("alert-"+t+" text-"+t)});var n=t.isString(e)?e:r.length?EW_IS_MOBILE?r.text():r.html():"";if(t.trim(n)=="")return;if(EW_IS_MOBILE){alert(n)}else{var o=t("#ewMsgBox");o.find(".modal-body").html(n);o.modal("show")}}function ew_Random(){return Math.floor(Math.random()*100001)+1e5}function ew_Upload(e){var t=jQuery,a=t(e);if(a.data("blueimpFileupload"))return;var r=a.attr("name"),i=r.replace(/\$/g,"\\$"),n=a.data("table"),o=a.is("[multiple]"),s=a.closest(".form-group,[id^='el_']"),l=s.find(".btn").css("display")=="none"||a.closest("form").find("#a_confirm").val()=="F",d=s.find("#ft_"+i),u=s.find("#fn_"+i),f=s.find("#fa_"+i),c=s.find("#fs_"+i),p=s.find("#fx_"+i),h=s.find("#fm_"+i),g=s.find("#fc_"+i);var _=function(e,t){if(t.result.files[0].error)return;var a=t.result.files[0].name;var r=o?u.val()?u.val().split(EW_MULTIPLE_UPLOAD_SEPARATOR):[]:[];r[r.length]=a;u.val(r.join(EW_MULTIPLE_UPLOAD_SEPARATOR));f.val("0");if(!o)d.find("tr:not(:last)").remove()};var w=function(e,a){var r={},i=t(e.originalEvent.target).data("url");if(i)i.replace(/(?:\?|&)([^&=]*)=?([^&]*)/g,function(e,t,a){if(t)r[t]=a});var n=r["id"];if(n&&r[n]){var o=r[n];var s=u.val()?u.val().split(EW_MULTIPLE_UPLOAD_SEPARATOR):[];t.each(s,function(e,t){if(t==decodeURIComponent(o)){s.splice(e,1);return false}});u.val(s.join(EW_MULTIPLE_UPLOAD_SEPARATOR));f.val("0")}};var v=function(e,a){var r=u.val()?u.val().split(EW_MULTIPLE_UPLOAD_SEPARATOR):[];for(var i=0;i<a.files.length;i++)r[r.length]=a.files[i].name;var n=parseInt(g.val(),10);if(t.isNumber(n)&&n>0&&r.length>n){ew_Alert(ewLanguage.Phrase("UploadErrMsgMaxNumberOfFiles"));return false}var o=parseInt(c.val(),10);if(t.isNumber(o)&&o>0&&r.join(EW_MULTIPLE_UPLOAD_SEPARATOR).length>o){ew_Alert(ewLanguage.Phrase("UploadErrMsgMaxFileLength"));return false}};var m=function(e){if(!o&&u.val()){if(!confirm(ewLanguage.Phrase("UploadOverwrite"))){e.preventDefault();e.stopPropagation()}}};var E=function(e){var a=t();t.each(e.files,function(r,i){var n=t('<tr class="template-upload fade">'+'<td class="preview"><span class="fade"></span></td>'+'<td class="name"></td>'+'<td class="size"></td>'+(i.error?'<td class="error text-danger" colspan="2"></td>':'<td><div class="progress">'+'<div class="progress-bar progress-bar-success" style="width: 0%;"></div></div></td>'+'<td><button type="button" class="btn btn-default btn-sm start">'+ewLanguage.Phrase("UploadStart")+"</button></td>")+'<td><button type="button" class="btn btn-default btn-sm cancel">'+ewLanguage.Phrase("UploadCancel")+"</button></td></tr>");n.find(".name").text(i.name);n.find(".size").text(e.formatFileSize(i.size));n.find(".start").click(m);n.find(".error").text(i.error);a=a.add(n)});return a};var b=function(e){var a=t();t.each(e.files,function(r,i){var n=t('<tr class="template-download fade">'+(i.error?'<td></td><td class="name"></td>'+'<td class="size"></td><td class="error text-danger" colspan="2"></td>':'<td class="preview"></td>'+'<td class="name"><a></a></td>'+'<td class="size"></td><td colspan="2"></td>')+(l?"":'<td><button type="button" class="btn btn-default btn-sm delete">'+ewLanguage.Phrase("UploadDelete")+"</button></td>")+"</tr>");n.find(".size").text(e.formatFileSize(i.size));if(i.error){n.find(".name").text(i.name);n.find(".error").text(i.error);if(!i.deleteUrl)n.find(".delete").click(function(){t(this).closest(".template-download").remove();S()})}else{var o=n.find(".name a").text(i.name);if(i.url)o.attr("href",i.url).attr("target","_blank");if(i.thumbnailUrl&&/\.(bmp|gif|jpe?g|png)$/i.test(i.name)){if(EW_USE_COLORBOX)o.colorbox(ewLightboxSettings);n.find(".preview").append('<img style="width: '+EW_UPLOAD_THUMBNAIL_WIDTH+'px;">').find("img").prop("src",i.thumbnailUrl)}else if(i.url&&/\.(mp4)$/i.test(i.name)){n.find(".preview").append('<video style="width: '+EW_UPLOAD_THUMBNAIL_WIDTH+'px;" controls><source type="video/mp4"></video>').find("source").prop("src",i.url)}else if(i.url&&/\.(mp3)$/i.test(i.name)){n.find(".preview").append('<audio style="width: '+EW_UPLOAD_THUMBNAIL_WIDTH+'px;" controls><source type="audio/mpeg"></audio>').find("source").prop("src",i.url)}n.find(".delete").attr("data-type",i.deleteType).attr("data-url",i.deleteUrl)}a=a.add(n)});return a};var S=function(){d.css("margin-top",d.find("tr")[0]&&!l?"10px":"0")};var y=function(){a.closest("span.fileinput-button").tooltip("hide")};var A=function(e,t){if(t.files&&t.files.error)ew_Alert(t.files[0].error)};var T=ew_GetForm(e),L=t(T);var x=L.find("#a_confirm").val()=="F";if(x)L.find("span.fileinput-button").hide();var O=parseInt(g.val(),10);var I=EW_UPLOAD_URL;var C={id:r,table:n,replace:o?"0":"1",exts:p.val(),maxsize:h.val(),maxfilecount:g.val()};if(ew_SameText(EW_UPLOAD_TYPE,"PUT"))I+="?"+t.param(C);a.fileupload({url:I,type:EW_UPLOAD_TYPE,multipart:ew_SameText(EW_UPLOAD_TYPE,"POST"),autoUpload:true,loadImageFileTypes:/^image\/(gif|jpe?g|png)$/i,loadVideoFileTypes:/^video\/(mp4)$/i,loadAudioFileTypes:/^audio\/(mpeg)$/i,acceptFileTypes:p.val()?new RegExp("\\.("+p.val().replace(/,/g,"|")+")$","i"):null,maxFileSize:parseInt(h.val(),10),maxNumberOfFiles:O>1?O:null,filesContainer:d,formData:C,uploadTemplateId:null,downloadTemplateId:null,uploadTemplate:E,downloadTemplate:b,previewMaxWidth:EW_UPLOAD_THUMBNAIL_WIDTH,previewMaxHeight:EW_UPLOAD_THUMBNAIL_HEIGHT,dropZone:s,pasteZone:s,messages:{acceptFileTypes:ewLanguage.Phrase("UploadErrMsgAcceptFileTypes"),maxFileSize:ewLanguage.Phrase("UploadErrMsgMaxFileSize"),maxNumberOfFiles:ewLanguage.Phrase("UploadErrMsgMaxNumberOfFiles"),minFileSize:ewLanguage.Phrase("UploadErrMsgMinFileSize")}}).on("fileuploaddone",_).on("fileuploaddestroy",w).on("fileuploadchange",v).on("fileuploadadded fileuploadfinished fileuploaddestroyed",S).on("fileuploadprocessfail",A).click(y);if(u.val())t.ajax({url:I,data:{id:r,table:n},dataType:"json",context:this,success:function(i){if(i&&i[r])a.fileupload("option","done").call(e,t.Event(),{result:{files:i[r]}});if(x)d.find("td.delete").hide()}})}function ew_ParseNumber(e,t){var a=jQuery;if(a.isString(e)){t=t||{thousandsSeparator:EW_THOUSANDS_SEP,decimalSeparator:EW_DECIMAL_POINT};var r=[],i,n=t.thousandsSeparator,o=t.decimalSeparator;if(n)r.push(n.replace(/[\-$\^*()+\[\]{}|\\,.?\s]/g,"\\$&")+"(?=\\d)");i=new RegExp("(?:"+r.join("|")+")","g");if(o===".")o=null;e=e.replace(i,"");e=o?e.replace(o,"."):e}if(a.isString(e)&&a.trim(e)!=="")e=+e;if(!a.isNumber||!isFinite(e))e=null;return e}function ew_FormatNumber(e,t){var a=jQuery;if(a.isNumber(e)){t=t||{thousandsSeparator:EW_THOUSANDS_SEP,decimalSeparator:EW_DECIMAL_POINT};var r=e<0,i=e+"",n=t.decimalPlaces,o=t.decimalSeparator||".",s=t.thousandsSeparator,l,d,u,f;if(a.isNumber(n)&&n>=0&&n<=20)i=e.toFixed(n);if(o!==".")i=i.replace(".",o);if(s){l=i.lastIndexOf(o);l=l>-1?l:i.length;d=i.substring(l);for(u=0,f=l;f>0;f--){if(u%3===0&&f!==l&&(!r||f>1))d=s+d;d=i.charAt(f-1)+d;u++}i=d}return i}else{return a.isValue(e)&&e.toString?e.toString():""}}function ew_ParseDate(e,t){var a=jQuery,r=a.makeArray(arguments);if(a.isNumber(t)&&t>=0&&t<=17){var i,n=EW_DATE_FORMAT.toUpperCase(),o=EW_DATE_SEPARATOR,s=EW_TIME_SEPARATOR;switch(t){case 0:case 1:case 2:case 8:i=n+" HH"+s+"mm"+s+"ss";break;case 3:i="hh:mm:ss A";break;case 4:i="HH:mm:ss";break;case 5:i="YYYY"+o+"MM"+o+"DD";break;case 6:i="MM"+o+"DD"+o+"YYYY";break;case 7:i="DD"+o+"MM"+o+"YYYY";break;case 9:i="YYYY"+o+"MM"+o+"DD HH"+s+"mm"+s+"ss";break;case 10:i="MM"+o+"DD"+o+"YYYY HH"+s+"mm"+s+"ss";break;case 11:i="DD"+o+"MM"+o+"YYYY HH"+s+"mm"+s+"ss";break;case 12:i="YY"+o+"MM"+o+"DD";break;case 13:i="MM"+o+"DD"+o+"YY";break;case 14:i="DD"+o+"MM"+o+"YY";break;case 15:i="YY"+o+"MM"+o+"DD HH"+s+"mm"+s+"ss";break;case 16:i="MM"+o+"DD"+o+"YY HH"+s+"mm"+s+"ss";break;case 17:i="DD"+o+"MM"+o+"YY HH"+s+"mm"+s+"ss";break}r[1]=[i,"YYYY-MM-DD HH"+s+"mm"+s+"ss"]}return moment.apply(this,r)}function ew_FormatDate(e,t){return moment(e).format(t||EW_DATE_FORMAT.toUpperCase())}if(!String.prototype.includes){String.prototype.includes=function(e,t){"use strict";if(typeof t!=="number"){t=0}if(t+e.length>this.length){return false}else{return this.indexOf(e,t)!==-1}}}if(!String.prototype.startsWith){String.prototype.startsWith=function(e,t){return this.substr(t||0,e.length)===e}}if(!String.prototype.endsWith){String.prototype.endsWith=function(e,t){if(!(t<this.length))t=this.length;else t|=0;return this.substr(t-e.length,e.length)===e}}if(!Array.prototype.includes){Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(this==null){throw new TypeError('"this" is null or not defined')}var a=Object(this);var r=a.length>>>0;if(r===0){return false}var i=t|0;var n=Math.max(i>=0?i:r-Math.abs(i),0);function o(e,t){return e===t||typeof e==="number"&&typeof t==="number"&&isNaN(e)&&isNaN(t)}while(n<r){if(o(a[n],e)){return true}n++}return false}})}if(!Array.prototype.indexOf){Array.prototype.indexOf=function(e,t){var a;if(this==null){throw new TypeError('"this" is null or not defined')}var r=Object(this);var i=r.length>>>0;if(i===0){return-1}var n=t|0;if(n>=i){return-1}a=Math.max(n>=0?n:i-Math.abs(n),0);while(a<i){if(a in r&&r[a]===e){return a}a++}return-1}}jQuery.extend({isBoolean:function(e){return typeof e==="boolean"},isNull:function(e){return e===null},isNumber:function(e){return typeof e==="number"&&isFinite(e)},isObject:function(e){return e&&(typeof e==="object"||this.isFunction(e))||false},isString:function(e){return typeof e==="string"},isUndefined:function(e){return typeof e==="undefined"},isValue:function(e){return this.isObject(e)||this.isString(e)||this.isNumber(e)||this.isBoolean(e)},isDate:function(e){
return this.type(e)==="date"&&e.toString()!=="Invalid Date"&&!isNaN(e)},later:function(e,t,a,r,i){e=e||0;t=t||{};var n=a,o=r,s,l;if(this.isString(a))n=t[a];if(!n)return;if(!this.isUndefined(r)&&!this.isArray(o))o=[r];s=function(){n.apply(t,o||[])};l=i?setInterval(s,e):setTimeout(s,e);return{interval:i,cancel:function(){if(this.interval){clearInterval(l)}else{clearTimeout(l)}}}}});if(!jQuery.sub){jQuery.sub=function(){function e(t,a){return new e.fn.init(t,a)}jQuery.extend(true,e,this);e.superclass=this;e.fn=e.prototype=this();e.fn.constructor=e;e.sub=this.sub;e.fn.init=function a(r,i){var n=jQuery.fn.init.call(this,r,i,t);return n instanceof e?n:e(n)};e.fn.init.prototype=e.fn;var t=e(document);return e}}(function(){var e=jQuery.sub();e.fn.extend({row:function(){var e=this.closest("#r_"+this.data("field").substr(2));if(!e[0])e=this.closest(".ewTable > tbody > tr");return e},visible:function(e){var t=this.closest("#r_"+this.data("field").substr(2));if(!t[0])t=this.closest("span[id^=el_]");if(typeof e!="undefined"){t.toggle(e);return this}else{return t.is(":visible")}},readonly:function(e){if(typeof e!="undefined"){this.prop("readOnly",e);return this}else{return this.prop("readOnly")}},disabled:function(e){if(typeof e!="undefined"){this.prop("disabled",e);return this}else{return this.prop("disabled")}},value:function(e){var t=this.attr("type");if(typeof e!="undefined"){if(!jQuery.isArray(e))e=[e];var t=this.attr("type");var a=t=="radio"||t=="checkbox"?this.get():this[0];ew_SelectOpt(a,e);return this}else{if(t=="checkbox"){return ew_GetOptValues(this.get())}else if(t=="radio"){return ew_GetOptValues(this.get()).join()}else if(ew_IsHiddenTextArea(this)){this.data("editor").save();return this.val()}else{return this.val()}}},toNumber:function(){return ew_ParseNumber(this.value())},toDate:function(){return ew_ParseDate(this.value(),this.data("format"))},toJsDate:function(){return ew_ParseDate(this.value(),this.data("format")).toDate()}});jQuery.fn.fields=function(t){var a=jQuery,r={},i=this.attr("id"),n=this[0],o,s,l;if(/^[xy](\d*)_/.test(i)){o=ew_GetForm(n);s=this.data("table");l=RegExp.$1}else if(n&&n.Form){o=n.$Element;s=n.ID.replace(new RegExp("^f|"+n.PageID+"$","g"),"");l=a(n.Form).data("rowindex")}var d="[data-table="+s+"][data-field"+(t?"=x_"+t:"")+"]";if(jQuery.isValue(l))d+="[name^=x"+l+"_]";if(o&&d){a(o).find(d).each(function(){var t=this.getAttribute("data-field").substr(2),a=this.getAttribute("name");t=/^y_/.test(a)?"y_"+t:t;r[t]=r[t]?r[t].add(this):e(this)})}return t?r[t]:r}})();+function(e){"use strict";var t=".dropdown-backdrop";var a=".ewDropdown";var r=function(t){e(t).on("click.bs.dropdown",this.toggle)};r.VERSION="3.3.7";function i(t){var a=t.attr("data-target");if(!a){a=t.attr("href");a=a&&/#[A-Za-z]/.test(a)&&a.replace(/.*(?=#[^\s]*$)/,"")}var r=a&&e(a);return r&&r.length?r:t.parent()}function n(r){if(r&&r.which===3)return;e(t).remove();e(a,e(r.currentTarget).is(a)?e(r.currentTarget).parent():document).each(function(){var t=e(this);var a=i(t);var n={relatedTarget:this};if(!a.hasClass("open"))return;if(r&&r.type=="click"&&/input|textarea/i.test(r.target.tagName)&&e.contains(a[0],r.target))return;a.trigger(r=e.Event("hide.bs.dropdown",n));if(r.isDefaultPrevented())return;t.attr("aria-expanded","false");a.removeClass("open").trigger(e.Event("hidden.bs.dropdown",n))})}r.prototype.toggle=function(t){var a=e(this);if(a.is(".disabled, :disabled"))return;var r=i(a);var o=r.hasClass("open");var s=t.target.nodeName;n(t);if(!o){if("ontouchstart"in document.documentElement&&!r.closest(".navbar-nav").length){e(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(e(this)).on("click",n)}var l={relatedTarget:this};r.trigger(t=e.Event("show.bs.dropdown",l));if(t.isDefaultPrevented())return;a.trigger("focus").attr("aria-expanded","true");r.toggleClass("open").trigger(e.Event("shown.bs.dropdown",l))}var d=a.attr("href");if(d&&d!="#"&&window.matchMedia){if(EW_IS_SCREEN_SM_MIN){return true}else{return s=="SPAN"}}return false};r.prototype.keydown=function(t){if(!/(38|40|27|32)/.test(t.which)||/input|textarea/i.test(t.target.tagName))return;var r=e(this);t.preventDefault();t.stopPropagation();if(r.is(".disabled, :disabled"))return;var n=i(r);var o=n.hasClass("open");if(!o&&t.which!=27||o&&t.which==27){if(t.which==27)n.find(a).trigger("focus");return r.trigger("click")}var s=" li:not(.disabled):visible a";var l=n.find(".dropdown-menu"+s);if(!l.length)return;var d=l.index(t.target);if(t.which==38&&d>0)d--;if(t.which==40&&d<l.length-1)d++;if(!~d)d=0;l.eq(d).trigger("focus")};function o(t){return this.each(function(){var a=e(this);var i=a.data("bs.dropdown");if(!i)a.data("bs.dropdown",i=new r(this));if(typeof t=="string")i[t].call(a)})}var s=e.fn.dropdown;e.fn.dropdown=o;e.fn.dropdown.Constructor=r;e.fn.dropdown.noConflict=function(){e.fn.dropdown=s;return this};e(document).on("click.bs.dropdown.data-api",n).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",a,r.prototype.toggle).on("keydown.bs.dropdown.data-api",a,r.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",r.prototype.keydown)}(jQuery);